
R version 3.4.3 (2017-11-30) -- "Kite-Eating Tree"
Copyright (C) 2017 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> library(tsDyn)
> 
> data(zeroyld)
> 
> 
> ###TVAR
> tvar<-TVAR(zeroyld[1:100,], lag=2, nthresh=2,thDelay=1,trim=0.1, plot=FALSE, include="const")
Best unique threshold 3.173 
Second best: 2.987 (conditionnal on th= 3.173 and Delay= 1 ) 	 SSR/AIC: 5.513542
Second best: 3.173 (conditionnal on th= 2.987 and Delay= 1 ) 	 SSR/AIC: 5.513542

Second step best thresholds 3.091 3.405 		 SSR: 5.359576 
> class(tvar)
[1] "TVAR"  "nlVar"
> tvar
Model TVAR with  2  thresholds

$Bdown
                   Intercept short.run -1 long.run -1 short.run -2 long.run -2
Equation short.run 0.2588048    1.0010115 -0.03033653   -0.1216495  0.07488954
Equation long.run  0.2537710    0.4796473  1.10618520   -0.5610622 -0.11992734

$Bmiddle
                   Intercept short.run -1 long.run -1 short.run -2 long.run -2
Equation short.run  5.184416    -1.034966   0.5343629    0.6156229  -0.6789873
Equation long.run   7.327257    -3.071481   1.9817578    1.4851627  -1.6385701

$Bup
                   Intercept short.run -1  long.run -1 short.run -2 long.run -2
Equation short.run  1.705713  0.379160720 -0.008943793    0.3090020 -0.13887286
Equation long.run   1.890135 -0.008113763  0.633504924   -0.1262766 -0.01764579


Threshold value[1] "3.091 3.405"
> print(tvar)
Model TVAR with  2  thresholds

$Bdown
                   Intercept short.run -1 long.run -1 short.run -2 long.run -2
Equation short.run 0.2588048    1.0010115 -0.03033653   -0.1216495  0.07488954
Equation long.run  0.2537710    0.4796473  1.10618520   -0.5610622 -0.11992734

$Bmiddle
                   Intercept short.run -1 long.run -1 short.run -2 long.run -2
Equation short.run  5.184416    -1.034966   0.5343629    0.6156229  -0.6789873
Equation long.run   7.327257    -3.071481   1.9817578    1.4851627  -1.6385701

$Bup
                   Intercept short.run -1  long.run -1 short.run -2 long.run -2
Equation short.run  1.705713  0.379160720 -0.008943793    0.3090020 -0.13887286
Equation long.run   1.890135 -0.008113763  0.633504924   -0.1262766 -0.01764579


Threshold value[1] "3.091 3.405"
> coefficients(tvar)
$Bdown
                   Intercept short.run -1 long.run -1 short.run -2 long.run -2
Equation short.run 0.2588048    1.0010115 -0.03033653   -0.1216495  0.07488954
Equation long.run  0.2537710    0.4796473  1.10618520   -0.5610622 -0.11992734

$Bmiddle
                   Intercept short.run -1 long.run -1 short.run -2 long.run -2
Equation short.run  5.184416    -1.034966   0.5343629    0.6156229  -0.6789873
Equation long.run   7.327257    -3.071481   1.9817578    1.4851627  -1.6385701

$Bup
                   Intercept short.run -1  long.run -1 short.run -2 long.run -2
Equation short.run  1.705713  0.379160720 -0.008943793    0.3090020 -0.13887286
Equation long.run   1.890135 -0.008113763  0.633504924   -0.1262766 -0.01764579

> 
> ##FIXME ?
> summary(tvar)$VAR
NULL
> tvar$VAR
NULL
> 
> 
> 
> coefficients(summary(tvar))
$Bdown
                   Intercept short.run -1 long.run -1 short.run -2 long.run -2
Equation short.run 0.2588048    1.0010115 -0.03033653   -0.1216495  0.07488954
Equation long.run  0.2537710    0.4796473  1.10618520   -0.5610622 -0.11992734

$Bmiddle
                   Intercept short.run -1 long.run -1 short.run -2 long.run -2
Equation short.run  5.184416    -1.034966   0.5343629    0.6156229  -0.6789873
Equation long.run   7.327257    -3.071481   1.9817578    1.4851627  -1.6385701

$Bup
                   Intercept short.run -1  long.run -1 short.run -2 long.run -2
Equation short.run  1.705713  0.379160720 -0.008943793    0.3090020 -0.13887286
Equation long.run   1.890135 -0.008113763  0.633504924   -0.1262766 -0.01764579

> logLik(tvar)
[1] 97.36061
> AIC(tvar)
[1] -686.9451
> BIC(tvar)
[1] -604.2262
> coef(tvar)
$Bdown
                   Intercept short.run -1 long.run -1 short.run -2 long.run -2
Equation short.run 0.2588048    1.0010115 -0.03033653   -0.1216495  0.07488954
Equation long.run  0.2537710    0.4796473  1.10618520   -0.5610622 -0.11992734

$Bmiddle
                   Intercept short.run -1 long.run -1 short.run -2 long.run -2
Equation short.run  5.184416    -1.034966   0.5343629    0.6156229  -0.6789873
Equation long.run   7.327257    -3.071481   1.9817578    1.4851627  -1.6385701

$Bup
                   Intercept short.run -1  long.run -1 short.run -2 long.run -2
Equation short.run  1.705713  0.379160720 -0.008943793    0.3090020 -0.13887286
Equation long.run   1.890135 -0.008113763  0.633504924   -0.1262766 -0.01764579

> deviance(tvar)
[1] 5.359576
> vcov(tvar)
              [,1]         [,2]         [,3]         [,4]         [,5]
 [1,]  0.057617015 -0.016678772 -0.002219302 -0.008384003  0.007281419
 [2,] -0.016678772  0.040573102 -0.012828054 -0.033285979  0.011299894
 [3,] -0.002219302 -0.012828054  0.016102232  0.013269491 -0.015472561
 [4,] -0.008384003 -0.033285979  0.013269491  0.037993985 -0.015415106
 [5,]  0.007281419  0.011299894 -0.015472561 -0.015415106  0.017361425
 [6,]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
 [7,]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
 [8,]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
 [9,]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[10,]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[11,]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[12,]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[13,]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[14,]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[15,]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[16,]  0.042710004 -0.012363543 -0.001645111 -0.006214845  0.005397528
[17,] -0.012363543  0.030075792 -0.009509105 -0.024674036  0.008376319
[18,] -0.001645111 -0.009509105  0.011936169  0.009836331 -0.011469410
[19,] -0.006214845 -0.024674036  0.009836331  0.028163959 -0.011426820
[20,]  0.005397528  0.008376319 -0.011469410 -0.011426820  0.012869575
[21,]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[22,]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[23,]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[24,]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[25,]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[26,]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[27,]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[28,]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[29,]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[30,]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
              [,6]        [,7]        [,8]         [,9]       [,10]       [,11]
 [1,]  0.000000000  0.00000000  0.00000000  0.000000000  0.00000000  0.00000000
 [2,]  0.000000000  0.00000000  0.00000000  0.000000000  0.00000000  0.00000000
 [3,]  0.000000000  0.00000000  0.00000000  0.000000000  0.00000000  0.00000000
 [4,]  0.000000000  0.00000000  0.00000000  0.000000000  0.00000000  0.00000000
 [5,]  0.000000000  0.00000000  0.00000000  0.000000000  0.00000000  0.00000000
 [6,]  7.696875398 -2.53204951  0.41528410  0.012329235 -0.20855908  0.00000000
 [7,] -2.532049508  0.90260049 -0.17317638 -0.083160578  0.11492829  0.00000000
 [8,]  0.415284105 -0.17317638  0.06531070  0.037608196 -0.05364079  0.00000000
 [9,]  0.012329235 -0.08316058  0.03760820  0.098243374 -0.05732165  0.00000000
[10,] -0.208559080  0.11492829 -0.05364079 -0.057321647  0.05877521  0.00000000
[11,]  0.000000000  0.00000000  0.00000000  0.000000000  0.00000000  0.75703070
[12,]  0.000000000  0.00000000  0.00000000  0.000000000  0.00000000 -0.16523973
[13,]  0.000000000  0.00000000  0.00000000  0.000000000  0.00000000 -0.03285248
[14,]  0.000000000  0.00000000  0.00000000  0.000000000  0.00000000 -0.01939184
[15,]  0.000000000  0.00000000  0.00000000  0.000000000  0.00000000  0.01649168
[16,]  0.000000000  0.00000000  0.00000000  0.000000000  0.00000000  0.00000000
[17,]  0.000000000  0.00000000  0.00000000  0.000000000  0.00000000  0.00000000
[18,]  0.000000000  0.00000000  0.00000000  0.000000000  0.00000000  0.00000000
[19,]  0.000000000  0.00000000  0.00000000  0.000000000  0.00000000  0.00000000
[20,]  0.000000000  0.00000000  0.00000000  0.000000000  0.00000000  0.00000000
[21,]  5.705494817 -1.87694286  0.30783937  0.009139344 -0.15459946  0.00000000
[22,] -1.876942863  0.66907441 -0.12837118 -0.061644788  0.08519337  0.00000000
[23,]  0.307839375 -0.12837118  0.04841313  0.027877984 -0.03976253  0.00000000
[24,]  0.009139344 -0.06164479  0.02787798  0.072825274 -0.04249106  0.00000000
[25,] -0.154599456  0.08519337 -0.03976253 -0.042491056  0.04356855  0.00000000
[26,]  0.000000000  0.00000000  0.00000000  0.000000000  0.00000000  0.56116729
[27,]  0.000000000  0.00000000  0.00000000  0.000000000  0.00000000 -0.12248794
[28,]  0.000000000  0.00000000  0.00000000  0.000000000  0.00000000 -0.02435270
[29,]  0.000000000  0.00000000  0.00000000  0.000000000  0.00000000 -0.01437467
[30,]  0.000000000  0.00000000  0.00000000  0.000000000  0.00000000  0.01222485
            [,12]        [,13]        [,14]       [,15]        [,16]
 [1,]  0.00000000  0.000000000  0.000000000  0.00000000  0.042710004
 [2,]  0.00000000  0.000000000  0.000000000  0.00000000 -0.012363543
 [3,]  0.00000000  0.000000000  0.000000000  0.00000000 -0.001645111
 [4,]  0.00000000  0.000000000  0.000000000  0.00000000 -0.006214845
 [5,]  0.00000000  0.000000000  0.000000000  0.00000000  0.005397528
 [6,]  0.00000000  0.000000000  0.000000000  0.00000000  0.000000000
 [7,]  0.00000000  0.000000000  0.000000000  0.00000000  0.000000000
 [8,]  0.00000000  0.000000000  0.000000000  0.00000000  0.000000000
 [9,]  0.00000000  0.000000000  0.000000000  0.00000000  0.000000000
[10,]  0.00000000  0.000000000  0.000000000  0.00000000  0.000000000
[11,] -0.16523973 -0.032852484 -0.019391845  0.01649168  0.000000000
[12,]  0.10350479 -0.017284975 -0.057794488  0.01445845  0.000000000
[13,] -0.01728497  0.032789700  0.009792150 -0.01613999  0.000000000
[14,] -0.05779449  0.009792150  0.071028490 -0.01737928  0.000000000
[15,]  0.01445845 -0.016139987 -0.017379275  0.01489168  0.000000000
[16,]  0.00000000  0.000000000  0.000000000  0.00000000  0.096152553
[17,]  0.00000000  0.000000000  0.000000000  0.00000000 -0.027833905
[18,]  0.00000000  0.000000000  0.000000000  0.00000000 -0.003703621
[19,]  0.00000000  0.000000000  0.000000000  0.00000000 -0.013991411
[20,]  0.00000000  0.000000000  0.000000000  0.00000000  0.012151393
[21,]  0.00000000  0.000000000  0.000000000  0.00000000  0.000000000
[22,]  0.00000000  0.000000000  0.000000000  0.00000000  0.000000000
[23,]  0.00000000  0.000000000  0.000000000  0.00000000  0.000000000
[24,]  0.00000000  0.000000000  0.000000000  0.00000000  0.000000000
[25,]  0.00000000  0.000000000  0.000000000  0.00000000  0.000000000
[26,] -0.12248794 -0.024352697 -0.014374673  0.01222485  0.000000000
[27,]  0.07672543 -0.012812905 -0.042841560  0.01071767  0.000000000
[28,] -0.01281290  0.024306157  0.007258667 -0.01196416  0.000000000
[29,] -0.04284156  0.007258667  0.052651584 -0.01288281  0.000000000
[30,]  0.01071767 -0.011964155 -0.012882808  0.01103882  0.000000000
             [,17]        [,18]        [,19]        [,20]        [,21]
 [1,] -0.012363543 -0.001645111 -0.006214845  0.005397528  0.000000000
 [2,]  0.030075792 -0.009509105 -0.024674036  0.008376319  0.000000000
 [3,] -0.009509105  0.011936169  0.009836331 -0.011469410  0.000000000
 [4,] -0.024674036  0.009836331  0.028163959 -0.011426820  0.000000000
 [5,]  0.008376319 -0.011469410 -0.011426820  0.012869575  0.000000000
 [6,]  0.000000000  0.000000000  0.000000000  0.000000000  5.705494817
 [7,]  0.000000000  0.000000000  0.000000000  0.000000000 -1.876942863
 [8,]  0.000000000  0.000000000  0.000000000  0.000000000  0.307839375
 [9,]  0.000000000  0.000000000  0.000000000  0.000000000  0.009139344
[10,]  0.000000000  0.000000000  0.000000000  0.000000000 -0.154599456
[11,]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[12,]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[13,]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[14,]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[15,]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[16,] -0.027833905 -0.003703621 -0.013991411  0.012151393  0.000000000
[17,]  0.067709293 -0.021407742 -0.055548380  0.018857514  0.000000000
[18,] -0.021407742  0.026871763  0.022144421 -0.025820953  0.000000000
[19,] -0.055548380  0.022144421  0.063405206 -0.025725072  0.000000000
[20,]  0.018857514 -0.025820953 -0.025725072  0.028973131  0.000000000
[21,]  0.000000000  0.000000000  0.000000000  0.000000000 12.844716536
[22,]  0.000000000  0.000000000  0.000000000  0.000000000 -4.225540430
[23,]  0.000000000  0.000000000  0.000000000  0.000000000  0.693035334
[24,]  0.000000000  0.000000000  0.000000000  0.000000000  0.020575302
[25,]  0.000000000  0.000000000  0.000000000  0.000000000 -0.348048023
[26,]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[27,]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[28,]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[29,]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[30,]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
            [,22]       [,23]        [,24]       [,25]       [,26]       [,27]
 [1,]  0.00000000  0.00000000  0.000000000  0.00000000  0.00000000  0.00000000
 [2,]  0.00000000  0.00000000  0.000000000  0.00000000  0.00000000  0.00000000
 [3,]  0.00000000  0.00000000  0.000000000  0.00000000  0.00000000  0.00000000
 [4,]  0.00000000  0.00000000  0.000000000  0.00000000  0.00000000  0.00000000
 [5,]  0.00000000  0.00000000  0.000000000  0.00000000  0.00000000  0.00000000
 [6,] -1.87694286  0.30783937  0.009139344 -0.15459946  0.00000000  0.00000000
 [7,]  0.66907441 -0.12837118 -0.061644788  0.08519337  0.00000000  0.00000000
 [8,] -0.12837118  0.04841313  0.027877984 -0.03976253  0.00000000  0.00000000
 [9,] -0.06164479  0.02787798  0.072825274 -0.04249106  0.00000000  0.00000000
[10,]  0.08519337 -0.03976253 -0.042491056  0.04356855  0.00000000  0.00000000
[11,]  0.00000000  0.00000000  0.000000000  0.00000000  0.56116729 -0.12248794
[12,]  0.00000000  0.00000000  0.000000000  0.00000000 -0.12248794  0.07672543
[13,]  0.00000000  0.00000000  0.000000000  0.00000000 -0.02435270 -0.01281290
[14,]  0.00000000  0.00000000  0.000000000  0.00000000 -0.01437467 -0.04284156
[15,]  0.00000000  0.00000000  0.000000000  0.00000000  0.01222485  0.01071767
[16,]  0.00000000  0.00000000  0.000000000  0.00000000  0.00000000  0.00000000
[17,]  0.00000000  0.00000000  0.000000000  0.00000000  0.00000000  0.00000000
[18,]  0.00000000  0.00000000  0.000000000  0.00000000  0.00000000  0.00000000
[19,]  0.00000000  0.00000000  0.000000000  0.00000000  0.00000000  0.00000000
[20,]  0.00000000  0.00000000  0.000000000  0.00000000  0.00000000  0.00000000
[21,] -4.22554043  0.69303533  0.020575302 -0.34804802  0.00000000  0.00000000
[22,]  1.50627973 -0.28900059 -0.138780219  0.19179488  0.00000000  0.00000000
[23,] -0.28900059  0.10899194  0.062761393 -0.08951693  0.00000000  0.00000000
[24,] -0.13878022  0.06276139  0.163950723 -0.09565964  0.00000000  0.00000000
[25,]  0.19179488 -0.08951693 -0.095659638  0.09808538  0.00000000  0.00000000
[26,]  0.00000000  0.00000000  0.000000000  0.00000000  1.26334963 -0.27575573
[27,]  0.00000000  0.00000000  0.000000000  0.00000000 -0.27575573  0.17273110
[28,]  0.00000000  0.00000000  0.000000000  0.00000000 -0.05482495 -0.02884555
[29,]  0.00000000  0.00000000  0.000000000  0.00000000 -0.03236154 -0.09644872
[30,]  0.00000000  0.00000000  0.000000000  0.00000000  0.02752168  0.02412858
             [,28]        [,29]       [,30]
 [1,]  0.000000000  0.000000000  0.00000000
 [2,]  0.000000000  0.000000000  0.00000000
 [3,]  0.000000000  0.000000000  0.00000000
 [4,]  0.000000000  0.000000000  0.00000000
 [5,]  0.000000000  0.000000000  0.00000000
 [6,]  0.000000000  0.000000000  0.00000000
 [7,]  0.000000000  0.000000000  0.00000000
 [8,]  0.000000000  0.000000000  0.00000000
 [9,]  0.000000000  0.000000000  0.00000000
[10,]  0.000000000  0.000000000  0.00000000
[11,] -0.024352697 -0.014374673  0.01222485
[12,] -0.012812905 -0.042841560  0.01071767
[13,]  0.024306157  0.007258667 -0.01196416
[14,]  0.007258667  0.052651584 -0.01288281
[15,] -0.011964155 -0.012882808  0.01103882
[16,]  0.000000000  0.000000000  0.00000000
[17,]  0.000000000  0.000000000  0.00000000
[18,]  0.000000000  0.000000000  0.00000000
[19,]  0.000000000  0.000000000  0.00000000
[20,]  0.000000000  0.000000000  0.00000000
[21,]  0.000000000  0.000000000  0.00000000
[22,]  0.000000000  0.000000000  0.00000000
[23,]  0.000000000  0.000000000  0.00000000
[24,]  0.000000000  0.000000000  0.00000000
[25,]  0.000000000  0.000000000  0.00000000
[26,] -0.054824954 -0.032361541  0.02752168
[27,] -0.028845549 -0.096448724  0.02412858
[28,]  0.054720180  0.016341357 -0.02693477
[29,]  0.016341357  0.118533920 -0.02900292
[30,] -0.026934769 -0.029002920  0.02485156
> df.residual(tvar)
[1] 83
> all.equal(summary(tvar)$VarCov[[1]], vcov(tvar))
[1] TRUE
> head(residuals(tvar))
     short.run    long.run
3 -0.004597009  0.13556926
4  0.042833906 -0.09146197
5  0.098364773 -0.05242712
6 -0.098242642 -0.11095025
7 -0.141652551 -0.10341638
8 -0.084140183  0.01981197
> tail(residuals(tvar))
      short.run    long.run
95  -0.13264030  0.09671450
96   0.12582712 -0.28920157
97   0.17823756  0.04344887
98  -0.15492010 -0.08167471
99   0.09760711  0.15553665
100  0.31886073  0.01232640
> head(fitted(tvar))
  short.run long.run
3  2.312597 1.626431
4  2.358166 1.864462
5  2.459635 1.860427
6  2.605243 1.920950
7  2.537653 1.806416
8  2.436140 1.663188
> tail(fitted(tvar))
    short.run long.run
95   3.776640 3.284285
96   3.775173 3.479202
97   3.812762 3.359551
98   3.950920 3.464675
99   3.875393 3.438463
100  3.883139 3.595674
> 
> regime(tvar)
  [1] NA NA  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
 [26]  1  1  1  1  2  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
 [51]  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  2  2  2  3  3  3  2  2
 [76]  2  3  3  3  3  3  3  3  2  1  2  1  1  1  1  1  2  3  3  3  3  3  3  3  3
> regime(tvar, initVal=FALSE)
 [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 1 1 1 1 1 1 1 1 1 1
[39] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 3 3 3 2 2 2 3 3
[77] 3 3 3 3 3 2 1 2 1 1 1 1 1 2 3 3 3 3 3 3 3 3
attr(,"tsp")
[1]   3 100   1
> regime(tvar, time=FALSE)
  [1] NA NA  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
 [26]  1  1  1  1  2  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
 [51]  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  2  2  2  3  3  3  2  2
 [76]  2  3  3  3  3  3  3  3  2  1  2  1  1  1  1  1  2  3  3  3  3  3  3  3  3
> regime(tvar, time=FALSE, initVal=FALSE)
 [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 1 1 1 1 1 1 1 1 1 1
[39] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 3 3 3 2 2 2 3 3
[77] 3 3 3 3 3 2 1 2 1 1 1 1 1 2 3 3 3 3 3 3 3 3
> 
> 
> ##FIXME
> options(show.signif.stars=TRUE)
> summary(tvar)
Model TVAR with  2  thresholds

Full sample size: 100 	End sample size: 98
Number of variables: 2 	Number of estimated parameters: 30 + 2
AIC -686.9451 	BIC -604.2262 	 SSR 5.359576 

[[1]]
                   Intercept       short.run -1      long.run -1      
Equation short.run 0.2588(0.2400)  1.0010(0.2014)*** -0.0303(0.1269)  
Equation long.run  0.2538(0.3101)  0.4796(0.2602).   1.1062(0.1639)***
                   short.run -2     long.run -2     
Equation short.run -0.1216(0.1949)  0.0749(0.1318)  
Equation long.run  -0.5611(0.2518)* -0.1199(0.1702) 

[[2]]
                   Intercept       short.run -1     long.run -1      
Equation short.run 5.1844(2.7743). -1.0350(0.9501)  0.5344(0.2556)*  
Equation long.run  7.3273(3.5840)* -3.0715(1.2273)* 1.9818(0.3301)***
                   short.run -2      long.run -2       
Equation short.run 0.6156(0.3134).   -0.6790(0.2424)** 
Equation long.run  1.4852(0.4049)*** -1.6386(0.3132)***

[[3]]
                   Intercept       short.run -1     long.run -1     
Equation short.run 1.7057(0.8701). 0.3792(0.3217)   -0.0089(0.1811) 
Equation long.run  1.8901(1.1240). -0.0081(0.4156)  0.6335(0.2339)**
                   short.run -2     long.run -2     
Equation short.run 0.3090(0.2665)   -0.1389(0.1220) 
Equation long.run  -0.1263(0.3443)  -0.0176(0.1576) 

---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

Threshold value: 3.091 3.405
Percentage of Observations in each regime: 71.4% 10.2% 18.4% 
> 
> options(show.signif.stars=FALSE)
> summary(tvar)
Model TVAR with  2  thresholds

Full sample size: 100 	End sample size: 98
Number of variables: 2 	Number of estimated parameters: 30 + 2
AIC -686.9451 	BIC -604.2262 	 SSR 5.359576 

[[1]]
                   Intercept      short.run -1   long.run -1    
Equation short.run 0.2588(0.2400) 1.0010(0.2014) -0.0303(0.1269)
Equation long.run  0.2538(0.3101) 0.4796(0.2602) 1.1062(0.1639) 
                   short.run -2    long.run -2    
Equation short.run -0.1216(0.1949) 0.0749(0.1318) 
Equation long.run  -0.5611(0.2518) -0.1199(0.1702)

[[2]]
                   Intercept      short.run -1    long.run -1    short.run -2  
Equation short.run 5.1844(2.7743) -1.0350(0.9501) 0.5344(0.2556) 0.6156(0.3134)
Equation long.run  7.3273(3.5840) -3.0715(1.2273) 1.9818(0.3301) 1.4852(0.4049)
                   long.run -2    
Equation short.run -0.6790(0.2424)
Equation long.run  -1.6386(0.3132)

[[3]]
                   Intercept      short.run -1    long.run -1    
Equation short.run 1.7057(0.8701) 0.3792(0.3217)  -0.0089(0.1811)
Equation long.run  1.8901(1.1240) -0.0081(0.4156) 0.6335(0.2339) 
                   short.run -2    long.run -2    
Equation short.run 0.3090(0.2665)  -0.1389(0.1220)
Equation long.run  -0.1263(0.3443) -0.0176(0.1576)


Threshold value: 3.091 3.405
Percentage of Observations in each regime: 71.4% 10.2% 18.4% 
> 
> print(summary(tvar), digits=3)
Model TVAR with  2  thresholds

Full sample size: 100 	End sample size: 98
Number of variables: 2 	Number of estimated parameters: 30 + 2
AIC -686.9451 	BIC -604.2262 	 SSR 5.359576 

[[1]]
                   Intercept    short.run -1 long.run -1   short.run -2 
Equation short.run 0.259(0.240) 1.001(0.201) -0.030(0.127) -0.122(0.195)
Equation long.run  0.254(0.310) 0.480(0.260) 1.106(0.164)  -0.561(0.252)
                   long.run -2  
Equation short.run 0.075(0.132) 
Equation long.run  -0.120(0.170)

[[2]]
                   Intercept    short.run -1  long.run -1  short.run -2
Equation short.run 5.184(2.774) -1.035(0.950) 0.534(0.256) 0.616(0.313)
Equation long.run  7.327(3.584) -3.071(1.227) 1.982(0.330) 1.485(0.405)
                   long.run -2  
Equation short.run -0.679(0.242)
Equation long.run  -1.639(0.313)

[[3]]
                   Intercept    short.run -1  long.run -1   short.run -2 
Equation short.run 1.706(0.870) 0.379(0.322)  -0.009(0.181) 0.309(0.267) 
Equation long.run  1.890(1.124) -0.008(0.416) 0.634(0.234)  -0.126(0.344)
                   long.run -2  
Equation short.run -0.139(0.122)
Equation long.run  -0.018(0.158)


Threshold value: 3.091 3.405
Percentage of Observations in each regime: 71.4% 10.2% 18.4% 
> 
> toLatex(tvar)
%insert in the preamble and uncomment the line you want for usual /medium /small matrix
%\usepackage{amsmath} \newenvironment{smatrix}{\begin{pmatrix}}{\end{pmatrix}} %USUAL
%\usepackage{amsmath} \newenvironment{smatrix}{\left(\begin{smallmatrix}}{\end{smallmatrix}\right)} %SMALL
%\usepackage{nccmath} \newenvironment{smatrix}{\left(\begin{mmatrix}}{\end{mmatrix}\right)} %MEDIUM
\begin{equation}
\begin{smatrix} %explained vector
X_{t}^{1} \\ X_{t}^{2}
\end{smatrix}=
\left\{
\begin{array}{ll}
\begin{smatrix}     %const
0.2588 \\ 0.2538
\end{smatrix}
+\begin{smatrix}      %Lag1
1.0010 & -0.0303 \\
0.4796 & 1.1062 
\end{smatrix}
\begin{smatrix}
X_{t-1}^{1} \\ X_{t-1}^{2}
\end{smatrix}
+\begin{smatrix}      %Lag2
-0.1216 & 0.0749 \\
-0.5611 & -0.1199 
\end{smatrix}
\begin{smatrix}
X_{t-2}^{1} \\ X_{t-2}^{2}
\end{smatrix}
& \text{if Th}< 3.091 \\
\begin{smatrix}     %const
5.1844 \\ 7.3273
\end{smatrix}
+\begin{smatrix}      %Lag1
-1.0350 & 0.5344 \\
-3.0715 & 1.9818 
\end{smatrix}
\begin{smatrix}
X_{t-1}^{1} \\ X_{t-1}^{2}
\end{smatrix}
+\begin{smatrix}      %Lag2
0.6156 & -0.6790 \\
1.4852 & -1.6386 
\end{smatrix}
\begin{smatrix}
X_{t-2}^{1} \\ X_{t-2}^{2}
\end{smatrix}
& \text{if } 3.091 < \text{Th} < 3.405 \\
\begin{smatrix}     %const
1.7057 \\ 1.8901
\end{smatrix}
+\begin{smatrix}      %Lag1
0.3792 & -0.0089 \\
-0.0081 & 0.6335 
\end{smatrix}
\begin{smatrix}
X_{t-1}^{1} \\ X_{t-1}^{2}
\end{smatrix}
+\begin{smatrix}      %Lag2
0.3090 & -0.1389 \\
-0.1263 & -0.0176 
\end{smatrix}
\begin{smatrix}
X_{t-2}^{1} \\ X_{t-2}^{2}
\end{smatrix}
& \text{if Th}> 3.405 \\
\end{array}
\right.
\end{equation}
> 
> if(FALSE) {##FIXME
+   toLatex(summary(tvar), digits=2)
+   tvar$coefficients
+   tvar$StDev
+   options(show.signif.stars=FALSE)
+   toLatex(summary(tvar), digits=2)
+ }
> 
> 
> #################################
> ### Many more TVARs
> #################################
> gr_args <- expand.grid(include= c("const", "trend", "none", "both"), 
+                        nthresh=1:2,
+                        lag=1:3,
+                        commonInter=c(FALSE, TRUE),
+                        thDelay=c(1,2),
+                        stringsAsFactors=FALSE)
> 
> ## remove if commonInter and const
> gr_args_ok <- subset(gr_args, !(commonInter & include!="const") & lag > thDelay) 
> 
> 
> ## run
> TVAR_outs <- mapply(TVAR,
+                     include=gr_args_ok$include,
+                     lag=gr_args_ok$lag,
+                     commonInter=gr_args_ok$commonInter,
+                     thDelay=gr_args_ok$thDelay,
+                     nthresh=gr_args_ok$nthresh,
+                     MoreArgs = list(data=zeroyld[1:100,], plot=FALSE, trace=TRUE),
+                     SIMPLIFY=FALSE)
Best unique threshold 3.173 
Best unique threshold 3.189 
Best unique threshold 3.189 
Best unique threshold 3.173 
Best unique threshold 3.173 
Second best: 2.987 (conditionnal on th= 3.173 and Delay= 1 ) 	 SSR/AIC: 5.513542
Second best: 3.173 (conditionnal on th= 2.987 and Delay= 1 ) 	 SSR/AIC: 5.513542

Second step best thresholds 3.091 3.405 		 SSR: 5.359576 
Best unique threshold 3.189 
Second best: 3.526 (conditionnal on th= 3.189 and Delay= 1 ) 	 SSR/AIC: 5.015707
Second best: 3.058 (conditionnal on th= 3.526 and Delay= 1 ) 	 SSR/AIC: 4.747578

Second step best thresholds 3.058 3.344 		 SSR: 4.589685 
Best unique threshold 3.189 
Second best: 3.712 (conditionnal on th= 3.189 and Delay= 1 ) 	 SSR/AIC: 5.854277
Second best: 3.173 (conditionnal on th= 3.712 and Delay= 1 ) 	 SSR/AIC: 5.831138

Second step best thresholds 3.058 3.344 		 SSR: 5.794965 
Best unique threshold 3.173 
Second best: 3.748 (conditionnal on th= 3.173 and Delay= 1 ) 	 SSR/AIC: 4.548898
Second best: 3.173 (conditionnal on th= 3.748 and Delay= 1 ) 	 SSR/AIC: 4.548898

Second step best thresholds 3.058 3.357 		 SSR: 4.250102 
Best unique threshold 3.173 
Best unique threshold 3.173 
Best unique threshold 3.173 
Best unique threshold 3.173 
Best unique threshold 3.173 
Second best: 3.748 (conditionnal on th= 3.173 and Delay= 1 ) 	 SSR/AIC: 4.826086
Second best: 3.173 (conditionnal on th= 3.748 and Delay= 1 ) 	 SSR/AIC: 4.826086

Second step best thresholds 3.062 3.357 		 SSR: 4.537429 
Best unique threshold 3.173 
Second best: 3.748 (conditionnal on th= 3.173 and Delay= 1 ) 	 SSR/AIC: 3.883083
Second best: 3.173 (conditionnal on th= 3.748 and Delay= 1 ) 	 SSR/AIC: 3.883083

Second step best thresholds 3.058 3.369 		 SSR: 3.701224 
Best unique threshold 3.173 
Second best: 3.748 (conditionnal on th= 3.173 and Delay= 1 ) 	 SSR/AIC: 4.907752
Second best: 3.173 (conditionnal on th= 3.748 and Delay= 1 ) 	 SSR/AIC: 4.907752

Second step best thresholds 3.173 3.748 		 SSR: 4.907752 
Best unique threshold 3.173 
Second best: 3.712 (conditionnal on th= 3.173 and Delay= 1 ) 	 SSR/AIC: 3.405836
Second best: 3.173 (conditionnal on th= 3.712 and Delay= 1 ) 	 SSR/AIC: 3.405836

Second step best thresholds 3.173 3.712 		 SSR: 3.405836 
Best unique threshold 3.173 
Best unique threshold 3.173 
Second best: 2.957 (conditionnal on th= 3.173 and Delay= 1 ) 	 SSR/AIC: 5.604876
Second best: 3.173 (conditionnal on th= 2.957 and Delay= 1 ) 	 SSR/AIC: 5.604876

Second step best thresholds 3.008 3.214 		 SSR: 5.381184 
Best unique threshold 3.173 
Best unique threshold 3.173 
Second best: 3.748 (conditionnal on th= 3.173 and Delay= 1 ) 	 SSR/AIC: 4.851913
Second best: 3.173 (conditionnal on th= 3.748 and Delay= 1 ) 	 SSR/AIC: 4.851913

Second step best thresholds 3.062 3.357 		 SSR: 4.754071 
Best unique threshold 3.003 
Best unique threshold 3.713 
Best unique threshold 3.003 
Best unique threshold 3.713 
Best unique threshold 3.003 
Second best: 3.195 (conditionnal on th= 3.003 and Delay= 2 ) 	 SSR/AIC: 5.028484
Second best: 3.003 (conditionnal on th= 3.195 and Delay= 2 ) 	 SSR/AIC: 5.028484

Second step best thresholds 3.003 3.195 		 SSR: 5.028484 
Best unique threshold 3.713 
Second best: 2.987 (conditionnal on th= 3.713 and Delay= 2 ) 	 SSR/AIC: 5.061632
Second best: 3.713 (conditionnal on th= 2.987 and Delay= 2 ) 	 SSR/AIC: 5.061632

Second step best thresholds 3.003 3.195 		 SSR: 4.974008 
Best unique threshold 3.003 
Second best: 3.195 (conditionnal on th= 3.003 and Delay= 2 ) 	 SSR/AIC: 5.251379
Second best: 3.003 (conditionnal on th= 3.195 and Delay= 2 ) 	 SSR/AIC: 5.251379

Second step best thresholds 3.003 3.195 		 SSR: 5.251379 
Best unique threshold 3.713 
Second best: 3.003 (conditionnal on th= 3.713 and Delay= 2 ) 	 SSR/AIC: 4.769659
Second best: 3.195 (conditionnal on th= 3.003 and Delay= 2 ) 	 SSR/AIC: 4.370522

Second step best thresholds 3.003 3.195 		 SSR: 4.370522 
Best unique threshold 3.003 
Best unique threshold 3.003 
Second best: 3.195 (conditionnal on th= 3.003 and Delay= 2 ) 	 SSR/AIC: 5.092174
Second best: 3.003 (conditionnal on th= 3.195 and Delay= 2 ) 	 SSR/AIC: 5.092174

Second step best thresholds 3.003 3.195 		 SSR: 5.092174 
> 
> names(TVAR_outs) <- paste("mod", 1:length(a), sep="_")
Error in paste("mod", 1:length(a), sep = "_") : object 'a' not found
Execution halted
