
R version 2.15.2 (2012-10-26) -- "Trick or Treat"
Copyright (C) 2012 The R Foundation for Statistical Computing
ISBN 3-900051-07-0
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> library(tsDyn)
> library(mnormt)
> 
> ################################################################
> ######### From man file:
> ################################################################
> #see that:
> a<-matrix(c(-0.2, 0.2), ncol=1)
> b<-matrix(c(1,-1), nrow=1)
> a%*%b
     [,1] [,2]
[1,] -0.2  0.2
[2,]  0.2 -0.2
> 
> set.seed(123)
> innov<-rmnorm(100, varcov=diag(2))
> vecm1<-TVECM.sim(B=rbind(c(-0.2, 0,0), c(0.2, 0,0)), nthresh=0, beta=1,n=100, lag=1,include="none", innov=innov)
> ECT<-vecm1[,1]-vecm1[,2]
> ECT[1:5]
[1]  0.0000  0.0000  0.1499 -0.3971  1.5671
> 
> #add an intercept as in panel B
> B2 <- rbind(c(-0.2, 0.1,0,0), c(0.2,0.4, 0,0))
> b<-TVECM.sim(B=B2, nthresh=0, n=100,beta=1, lag=1,include="const", innov=innov, show.parMat=TRUE)
         ECT Const Trend L{x1}{1} L{x2}{1}
Equ x1: -0.2   0.1     0        0        0
Equ x2:  0.2   0.4     0        0        0
> b[1:5,]
        [,1]    [,2]
[1,]  0.0000  0.0000
[2,]  0.0000  0.0000
[3,] -0.4605 -0.3104
[4,] -0.5606  0.3165
[5,]  1.2735  0.2944
> 
> 
> ##Bootstrap a TVECM with 1 threshold (two regimes)
> data(zeroyld)
> dat<-zeroyld
> TVECMobject<-TVECM(dat, nthresh=1, lag=1, ngridBeta=20, th1=list(exact=-1.195), plot=FALSE)
> tv_1_boot <-TVECM.sim(TVECMobject=TVECMobject,type="boot", seed=123, show.parMat=TRUE)
                         ECT     Const Trend short.run t -1 long.run t -1
Equation short.run 0.2025264 0.4857667     0      0.2252923   -0.09926611
Equation long.run  0.9575983 1.5929831     0      0.8703592    0.02252604
                           ECT        Const Trend short.run t -1 long.run t -1
Equation short.run 0.001291099  0.004290751     0    -0.02328976    0.06741675
Equation long.run  0.058816293 -0.007954949     0     0.16032265    0.14668443
> head(tv_1_boot)
      [,1]   [,2]
[1,] 2.183  1.575
[2,] 2.246  1.545
[3,] 2.237  1.403
[4,] 1.610  0.940
[5,] 1.441  0.650
[6,] 0.697 -0.067
> 
> ##Check the bootstrap
> all(TVECM.sim(TVECMobject=TVECMobject,type="check")==dat)
[1] TRUE
> 
> ## check correspondance bootstrap/simul:
> tv_1_sim <-TVECM.sim(B=tsDyn:::coefMat.nlVar(TVECMobject),type="simul", beta=TVECMobject$model.specific$beta,
+                         Thresh=getTh(TVECMobject), show.parMat=TRUE, seed=123, innov=matrix(0,200,2))
          ECT_low Const_low Trend_low L{x1}{1}_low L{x2}{1}_low     ECT_upr
Equ x1: 0.2025264 0.4857667         0    0.2252923  -0.09926611 0.001291099
Equ x2: 0.9575983 1.5929831         0    0.8703592   0.02252604 0.058816293
           Const_upr Trend_upr L{x1}{1}_upr L{x2}{1}_upr
Equ x1:  0.004290751         0  -0.02328976   0.06741675
Equ x2: -0.007954949         0   0.16032265   0.14668443
> head(tv_1_boot)
      [,1]   [,2]
[1,] 2.183  1.575
[2,] 2.246  1.545
[3,] 2.237  1.403
[4,] 1.610  0.940
[5,] 1.441  0.650
[6,] 0.697 -0.067
> 
> tv_1_sim <-TVECM.sim(B=tsDyn:::coefMat.nlVar(TVECMobject),type="simul", 
+                      beta=TVECMobject$model.specific$beta,
+                      Thresh=getTh(TVECMobject), show.parMat=TRUE, seed=123)
          ECT_low Const_low Trend_low L{x1}{1}_low L{x2}{1}_low     ECT_upr
Equ x1: 0.2025264 0.4857667         0    0.2252923  -0.09926611 0.001291099
Equ x2: 0.9575983 1.5929831         0    0.8703592   0.02252604 0.058816293
           Const_upr Trend_upr L{x1}{1}_upr L{x2}{1}_upr
Equ x1:  0.004290751         0  -0.02328976   0.06741675
Equ x2: -0.007954949         0   0.16032265   0.14668443
> head(tv_1_boot)
      [,1]   [,2]
[1,] 2.183  1.575
[2,] 2.246  1.545
[3,] 2.237  1.403
[4,] 1.610  0.940
[5,] 1.441  0.650
[6,] 0.697 -0.067
> 
> 
> ################################################################
> ######### Check error message when matrix badly specified:
> ################################################################
> 
> B<-matrix(rnorm(14), byrow=TRUE,ncol=7)
> 
> ## 0 thresh
> try(a<-TVECM.sim(B=B, beta=1, nthresh=0, n=100, lag=1,show.parMat=TRUE, include="none"))
Matrix B badly specified: should have  3 columns, but has 7 
       ECT L{x1}{1} L{x2}{1}
Equ x1  NA       NA       NA
Equ x2  NA       NA       NA
Error in TVECM.sim(B = B, beta = 1, nthresh = 0, n = 100, lag = 1, show.parMat = TRUE,  : 
  
> try(a<-TVECM.sim(B=B, beta=1, nthresh=0, n=100, lag=1,show.parMat=TRUE, include="const"))
Matrix B badly specified: should have  4 columns, but has 7 
       ECT const L{x1}{1} L{x2}{1}
Equ x1  NA    NA       NA       NA
Equ x2  NA    NA       NA       NA
Error in TVECM.sim(B = B, beta = 1, nthresh = 0, n = 100, lag = 1, show.parMat = TRUE,  : 
  
> try(a<-TVECM.sim(B=B, beta=1, nthresh=0, n=100, lag=1,show.parMat=TRUE, include="both"))
Matrix B badly specified: should have  5 columns, but has 7 
       ECT const trend L{x1}{1} L{x2}{1}
Equ x1  NA    NA    NA       NA       NA
Equ x2  NA    NA    NA       NA       NA
Error in TVECM.sim(B = B, beta = 1, nthresh = 0, n = 100, lag = 1, show.parMat = TRUE,  : 
  
> try(a<-TVECM.sim(B=B, beta=1, nthresh=0, n=100, lag=1,show.parMat=TRUE, include="trend"))
Matrix B badly specified: should have  4 columns, but has 7 
       ECT trend L{x1}{1} L{x2}{1}
Equ x1  NA    NA       NA       NA
Equ x2  NA    NA       NA       NA
Error in TVECM.sim(B = B, beta = 1, nthresh = 0, n = 100, lag = 1, show.parMat = TRUE,  : 
  
> 
> try(a<-TVECM.sim(B=B, beta=1, nthresh=0, n=100, lag=2,show.parMat=TRUE, include="none"))
Matrix B badly specified: should have  5 columns, but has 7 
       ECT L{x1}{1} L{x2}{1} L{x1}{2} L{x2}{2}
Equ x1  NA       NA       NA       NA       NA
Equ x2  NA       NA       NA       NA       NA
Error in TVECM.sim(B = B, beta = 1, nthresh = 0, n = 100, lag = 2, show.parMat = TRUE,  : 
  
> try(a<-TVECM.sim(B=B, beta=1, nthresh=0, n=100, lag=2,show.parMat=TRUE, include="const"))
Matrix B badly specified: should have  6 columns, but has 7 
       ECT const L{x1}{1} L{x2}{1} L{x1}{2} L{x2}{2}
Equ x1  NA    NA       NA       NA       NA       NA
Equ x2  NA    NA       NA       NA       NA       NA
Error in TVECM.sim(B = B, beta = 1, nthresh = 0, n = 100, lag = 2, show.parMat = TRUE,  : 
  
> 
> ## 1 thresh  
> try(a<-TVECM.sim(B=B, beta=1, nthresh=1, Thresh=0, n=100, lag=1,show.parMat=TRUE, include="none"))
Matrix B badly specified: should have  6 columns, but has 7 
       ECT_low L{x1}{1}_low L{x2}{1}_low ECT_upr L{x1}{1}_upr L{x2}{1}_upr
Equ x1      NA           NA           NA      NA           NA           NA
Equ x2      NA           NA           NA      NA           NA           NA
Error in TVECM.sim(B = B, beta = 1, nthresh = 1, Thresh = 0, n = 100,  : 
  
> try(a<-TVECM.sim(B=B, beta=1, nthresh=1, Thresh=0, n=100, lag=1,show.parMat=TRUE, include="const"))
Matrix B badly specified: should have  8 columns, but has 7 
       ECT_low const_low L{x1}{1}_low L{x2}{1}_low ECT_upr const_upr
Equ x1      NA        NA           NA           NA      NA        NA
Equ x2      NA        NA           NA           NA      NA        NA
       L{x1}{1}_upr L{x2}{1}_upr
Equ x1           NA           NA
Equ x2           NA           NA
Error in TVECM.sim(B = B, beta = 1, nthresh = 1, Thresh = 0, n = 100,  : 
  
> try(a<-TVECM.sim(B=B, beta=1, nthresh=1, Thresh=0, n=100, lag=1,show.parMat=TRUE, include="both"))
Matrix B badly specified: should have  10 columns, but has 7 
       ECT_low const_low trend_low L{x1}{1}_low L{x2}{1}_low ECT_upr const_upr
Equ x1      NA        NA        NA           NA           NA      NA        NA
Equ x2      NA        NA        NA           NA           NA      NA        NA
       trend_upr L{x1}{1}_upr L{x2}{1}_upr
Equ x1        NA           NA           NA
Equ x2        NA           NA           NA
Error in TVECM.sim(B = B, beta = 1, nthresh = 1, Thresh = 0, n = 100,  : 
  
> try(a<-TVECM.sim(B=B, beta=1, nthresh=1, Thresh=0, n=100, lag=1,show.parMat=TRUE, include="trend"))
Matrix B badly specified: should have  8 columns, but has 7 
       ECT_low trend_low L{x1}{1}_low L{x2}{1}_low ECT_upr trend_upr
Equ x1      NA        NA           NA           NA      NA        NA
Equ x2      NA        NA           NA           NA      NA        NA
       L{x1}{1}_upr L{x2}{1}_upr
Equ x1           NA           NA
Equ x2           NA           NA
Error in TVECM.sim(B = B, beta = 1, nthresh = 1, Thresh = 0, n = 100,  : 
  
> 
> try(a<-TVECM.sim(B=B, beta=1, nthresh=1, Thresh=0, n=100, lag=2,show.parMat=TRUE, include="const"))
Matrix B badly specified: should have  12 columns, but has 7 
       ECT_low const_low L{x1}{1}_low L{x2}{1}_low L{x1}{2}_low L{x2}{2}_low
Equ x1      NA        NA           NA           NA           NA           NA
Equ x2      NA        NA           NA           NA           NA           NA
       ECT_upr const_upr L{x1}{1}_upr L{x2}{1}_upr L{x1}{2}_upr L{x2}{2}_upr
Equ x1      NA        NA           NA           NA           NA           NA
Equ x2      NA        NA           NA           NA           NA           NA
Error in TVECM.sim(B = B, beta = 1, nthresh = 1, Thresh = 0, n = 100,  : 
  
> 
> ## 2 thresh
> try(a<-TVECM.sim(B=B, beta=1, nthresh=2, Thresh=0, n=100, lag=1,show.parMat=TRUE, include="none"))
Matrix B badly specified: should have  9 columns, but has 7 
       ECT_low L{x1}{1}_low L{x2}{1}_low ECT_mid L{x1}{1}_mid L{x2}{1}_mid
Equ x1      NA           NA           NA      NA           NA           NA
Equ x2      NA           NA           NA      NA           NA           NA
       ECT_upr L{x1}{1}_upr L{x2}{1}_upr
Equ x1      NA           NA           NA
Equ x2      NA           NA           NA
Error in TVECM.sim(B = B, beta = 1, nthresh = 2, Thresh = 0, n = 100,  : 
  
> try(a<-TVECM.sim(B=B, beta=1, nthresh=2, Thresh=0, n=100, lag=2,show.parMat=TRUE, include="const"))
Matrix B badly specified: should have  18 columns, but has 7 
       ECT_low const_low L{x1}{1}_low L{x2}{1}_low L{x1}{2}_low L{x2}{2}_low
Equ x1      NA        NA           NA           NA           NA           NA
Equ x2      NA        NA           NA           NA           NA           NA
       ECT_mid const_mid L{x1}{1}_mid L{x2}{1}_mid L{x1}{2}_mid L{x2}{2}_mid
Equ x1      NA        NA           NA           NA           NA           NA
Equ x2      NA        NA           NA           NA           NA           NA
       ECT_upr const_upr L{x1}{1}_upr L{x2}{1}_upr L{x1}{2}_upr L{x2}{2}_upr
Equ x1      NA        NA           NA           NA           NA           NA
Equ x2      NA        NA           NA           NA           NA           NA
Error in TVECM.sim(B = B, beta = 1, nthresh = 2, Thresh = 0, n = 100,  : 
  
> 
> 
> proc.time()
utilisateur     système      écoulé 
      2.400       0.080       2.478 
