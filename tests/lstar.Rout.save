
R version 2.15.2 (2012-10-26) -- "Trick or Treat"
Copyright (C) 2012 The R Foundation for Statistical Computing
ISBN 3-900051-07-0
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> library(tsDyn)
> 
> mod.lstar <- lstar(log10(lynx), m=2, mTh=c(0,1), control=list(maxit=3000))
Using maximum autoregressive order for low regime: mL = 2 
Using maximum autoregressive order for high regime: mH = 2 
Performing grid search for starting values...
Starting values fixed: gamma =  11.15385 , th =  3.337486 ; SSE =  4.337664 
Optimization algorithm converged
Optimized values fixed for regime 2  : gamma =  11.15383 , th =  3.339199 ; SSE =  4.337643 
> mod.lstar

Non linear autoregressive model

LSTAR model
Coefficients:
Low regime:
    const1     phi1.1     phi1.2 
 0.4891014  1.2465399 -0.3664328 

High regime:
    const2     phi2.1     phi2.2 
-1.0240758  0.4232669 -0.2546088 

Smoothing parameter: gamma = 11.15 

Threshold
Variable: Z(t) = + (0) X(t) + (1) X(t-1)

Value: 3.339 
> print(summary(mod.lstar), digits=2)

Non linear autoregressive model

LSTAR model
Coefficients:
Low regime:
    const1     phi1.1     phi1.2 
 0.4891014  1.2465399 -0.3664328 

High regime:
    const2     phi2.1     phi2.2 
-1.0240758  0.4232669 -0.2546088 

Smoothing parameter: gamma = 11.15 

Threshold
Variable: Z(t) = + (0) X(t) + (1) X(t-1)

Value: 3.339 

Residuals:
   Min     1Q Median     3Q    Max 
-0.595 -0.107  0.014  0.111  0.510 

Fit:
residuals variance = 0.03805,  AIC = -357, MAPE = 5.58%

Coefficient(s):
        Estimate  Std. Error  t value Pr(>|z|)    
const1     0.489       0.205      2.4     0.02 *  
phi1.1     1.247       0.068     18.4   <2e-16 ***
phi1.2    -0.366       0.104     -3.5    4e-04 ***
const2    -1.024       2.430     -0.4     0.67    
phi2.1     0.423       0.172      2.5     0.01 *  
phi2.2    -0.255       0.585     -0.4     0.66    
gamma     11.154      10.005      1.1     0.26    
th         3.339       0.093     36.0   <2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

Non-linearity test of full-order LSTAR model against full-order AR model
 F = 12 ; p-value = 1.4e-05 

Threshold 
Variable: Z(t) = + (0) X(t) + (1) X(t-1)
> deviance(mod.lstar)
         [,1]
[1,] 4.337643
> c(AIC(mod.lstar),BIC(mod.lstar))
[1] -356.6509 -334.7613
> 
> mod.lstar2 <- lstar(log10(lynx), m=1, control=list(maxit=3000))
Using maximum autoregressive order for low regime: mL = 1 
Using maximum autoregressive order for high regime: mH = 1 
Using default threshold variable: thDelay=0
Performing grid search for starting values...
Starting values fixed: gamma =  100 , th =  3.23744 ; SSE =  12.59824 
Grid search selected lower/upper bound gamma (was:  1 100 ]). 
					  Might try to widen bound with arg: 'starting.control=list(gammaInt=c(1,200))'
Optimization algorithm converged
Optimized values fixed for regime 2  : gamma =  100.0031 , th =  3.235652 ; SSE =  12.59746 
> mod.lstar2

Non linear autoregressive model

LSTAR model
Coefficients:
Low regime:
   const1    phi1.1 
0.2884595 0.9280287 

High regime:
    const2     phi2.1 
-0.6726318  0.1331190 

Smoothing parameter: gamma = 100 

Threshold
Variable: Z(t) = + (1) X(t) 

Value: 3.236 
> print(summary(mod.lstar2), digits=2)

Non linear autoregressive model

LSTAR model
Coefficients:
Low regime:
   const1    phi1.1 
0.2884595 0.9280287 

High regime:
    const2     phi2.1 
-0.6726318  0.1331190 

Smoothing parameter: gamma = 100 

Threshold
Variable: Z(t) = + (1) X(t) 

Value: 3.236 

Residuals:
   Min     1Q Median     3Q    Max 
-1.005 -0.130  0.094  0.236  0.647 

Fit:
residuals variance = 0.1105,  AIC = -239, MAPE = 9.965%

Coefficient(s):
        Estimate  Std. Error  t value Pr(>|z|)    
const1     0.288       0.246      1.2      0.2    
phi1.1     0.928       0.094      9.9   <2e-16 ***
const2    -0.673       1.337     -0.5      0.6    
phi2.1     0.133       0.385      0.3      0.7    
gamma    100.003      93.793      1.1      0.3    
th         3.236       0.021    153.8   <2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

Non-linearity test of full-order LSTAR model against full-order AR model
 F = 0.77 ; p-value = 0.38 

Threshold 
Variable: Z(t) = + (1) X(t) 
> deviance(mod.lstar2)
         [,1]
[1,] 12.59746
> c(AIC(mod.lstar2),BIC(mod.lstar2))
[1] -239.1082 -222.6910
> 
> ## include: none
> mod.lstar_noConst <- lstar(log10(lynx), m=2, control=list(maxit=1000), include="none")
Using maximum autoregressive order for low regime: mL = 2 
Using maximum autoregressive order for high regime: mH = 2 
Using default threshold variable: thDelay=0
Performing grid search for starting values...
Starting values fixed: gamma =  3.538462 , th =  2.719919 ; SSE =  4.933078 
Optimization algorithm converged
Optimized values fixed for regime 2  : gamma =  2.456908 , th =  2.707843 ; SSE =  4.907455 
> mod.lstar_noConst

Non linear autoregressive model

LSTAR model
Coefficients:
Low regime:
    phi1.1     phi1.2 
 1.4005126 -0.2253725 

High regime:
    phi2.1     phi2.2 
 0.7660504 -1.0552844 

Smoothing parameter: gamma = 2.457 

Threshold
Variable: Z(t) = + (1) X(t) + (0) X(t-1)

Value: 2.708 
> print(summary(mod.lstar_noConst), digits=2)

Non linear autoregressive model

LSTAR model
Coefficients:
Low regime:
    phi1.1     phi1.2 
 1.4005126 -0.2253725 

High regime:
    phi2.1     phi2.2 
 0.7660504 -1.0552844 

Smoothing parameter: gamma = 2.457 

Threshold
Variable: Z(t) = + (1) X(t) + (0) X(t-1)

Value: 2.708 

Residuals:
   Min     1Q Median     3Q    Max 
-0.577 -0.134  0.025  0.147  0.508 

Fit:
residuals variance = 0.04305,  AIC = -347, MAPE = 6.175%

Coefficient(s):
        Estimate  Std. Error  t value Pr(>|z|)    
phi1.1      1.40        0.17      8.0    9e-16 ***
phi1.2     -0.23        0.21     -1.1    0.289    
phi2.1      0.77        0.32      2.4    0.016 *  
phi2.2     -1.06        0.38     -2.8    0.006 ** 
gamma       2.46        1.31      1.9    0.060 .  
th          2.71        0.16     17.1   <2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

Non-linearity test of full-order LSTAR model against full-order AR model
 F = 8.5 ; p-value = 0.00037 

Threshold 
Variable: Z(t) = + (1) X(t) + (0) X(t-1)
> deviance(mod.lstar_noConst)
         [,1]
[1,] 4.907455
> c(AIC(mod.lstar_noConst),BIC(mod.lstar_noConst))
[1] -346.5805 -330.1633
> 
> ## include: trend
> mod.lstar_trend <- lstar(log10(lynx), m=2, control=list(maxit=1000), include="trend")
Using maximum autoregressive order for low regime: mL = 2 
Using maximum autoregressive order for high regime: mH = 2 
Using default threshold variable: thDelay=0
Performing grid search for starting values...
Starting values fixed: gamma =  3.538462 , th =  2.712901 ; SSE =  4.899802 
Optimization algorithm converged
Optimized values fixed for regime 2  : gamma =  2.575672 , th =  2.697974 ; SSE =  4.880102 
> mod.lstar_trend

Non linear autoregressive model

LSTAR model
Coefficients:
Low regime:
       trend1        phi1.1        phi1.2 
 1.825193e-05  1.403688e+00 -2.333263e-01 

High regime:
       trend2        phi2.1        phi2.2 
 0.0006932109  0.7390089035 -1.0305204430 

Smoothing parameter: gamma = 2.576 

Threshold
Variable: Z(t) = + (1) X(t) + (0) X(t-1)

Value: 2.698 
> print(summary(mod.lstar_trend), digits=2)

Non linear autoregressive model

LSTAR model
Coefficients:
Low regime:
       trend1        phi1.1        phi1.2 
 1.825193e-05  1.403688e+00 -2.333263e-01 

High regime:
       trend2        phi2.1        phi2.2 
 0.0006932109  0.7390089035 -1.0305204430 

Smoothing parameter: gamma = 2.576 

Threshold
Variable: Z(t) = + (1) X(t) + (0) X(t-1)

Value: 2.698 

Residuals:
   Min     1Q Median     3Q    Max 
-0.597 -0.132  0.024  0.144  0.521 

Fit:
residuals variance = 0.04281,  AIC = -343, MAPE = 6.137%

Coefficient(s):
        Estimate  Std. Error  t value Pr(>|z|)    
trend1   1.8e-05     1.6e-03      0.0    0.991    
phi1.1   1.4e+00     1.7e-01      8.5   <2e-16 ***
phi1.2  -2.3e-01     2.1e-01     -1.1    0.268    
trend2   6.9e-04     2.4e-03      0.3    0.771    
phi2.1   7.4e-01     3.0e-01      2.5    0.013 *  
phi2.2  -1.0e+00     3.6e-01     -2.9    0.004 ** 
gamma    2.6e+00     1.4e+00      1.9    0.057 .  
th       2.7e+00     1.7e-01     16.2   <2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

Non-linearity test of full-order LSTAR model against full-order AR model
 F = 8.5 ; p-value = 0.00037 

Threshold 
Variable: Z(t) = + (1) X(t) + (0) X(t-1)
> deviance(mod.lstar_trend)
         [,1]
[1,] 4.880102
> c(AIC(mod.lstar_trend),BIC(mod.lstar_trend))
[1] -343.2177 -321.3281
> 
> ## include: both
> mod.lstar_both <- lstar(log10(lynx), m=2, control=list(maxit=1000), include="both")
Using maximum autoregressive order for low regime: mL = 2 
Using maximum autoregressive order for high regime: mH = 2 
Using default threshold variable: thDelay=0
Performing grid search for starting values...
Starting values fixed: gamma =  100 , th =  2.565527 ; SSE =  4.581837 
Grid search selected lower/upper bound gamma (was:  1 100 ]). 
					  Might try to widen bound with arg: 'starting.control=list(gammaInt=c(1,200))'
Optimization algorithm converged
Optimized values fixed for regime 2  : gamma =  100.0001 , th =  2.568063 ; SSE =  4.580635 
> mod.lstar_both

Non linear autoregressive model

LSTAR model
Coefficients:
Low regime:
       const1        trend1        phi1.1        phi1.2 
 0.3869417359  0.0002595822  1.2409824738 -0.3277026131 

High regime:
       const2        trend2        phi2.1        phi2.2 
 0.7981219886  0.0001995693  0.3034500606 -0.6346479944 

Smoothing parameter: gamma = 100 

Threshold
Variable: Z(t) = + (1) X(t) + (0) X(t-1)

Value: 2.568 
> print(summary(mod.lstar_both), digits=2)

Non linear autoregressive model

LSTAR model
Coefficients:
Low regime:
       const1        trend1        phi1.1        phi1.2 
 0.3869417359  0.0002595822  1.2409824738 -0.3277026131 

High regime:
       const2        trend2        phi2.1        phi2.2 
 0.7981219886  0.0001995693  0.3034500606 -0.6346479944 

Smoothing parameter: gamma = 100 

Threshold
Variable: Z(t) = + (1) X(t) + (0) X(t-1)

Value: 2.568 

Residuals:
   Min     1Q Median     3Q    Max 
-0.587 -0.120  0.041  0.132  0.488 

Fit:
residuals variance = 0.04018,  AIC = -346, MAPE = 5.915%

Coefficient(s):
        Estimate  Std. Error  t value Pr(>|z|)    
const1   3.9e-01     3.2e-01      1.2     0.22    
trend1   2.6e-04     1.3e-03      0.2     0.84    
phi1.1   1.2e+00     1.5e-01      8.2    2e-16 ***
phi1.2  -3.3e-01     9.9e-02     -3.3    9e-04 ***
const2   8.0e-01     3.7e-01      2.2     0.03 *  
trend2   2.0e-04     1.5e-03      0.1     0.89    
phi2.1   3.0e-01     1.7e-01      1.8     0.07 .  
phi2.2  -6.3e-01     1.2e-01     -5.2    2e-07 ***
gamma    1.0e+02     8.1e+01      1.2     0.21    
th       2.6e+00     1.5e-02    173.7   <2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

Non-linearity test of full-order LSTAR model against full-order AR model
 F = 8.5 ; p-value = 0.00037 

Threshold 
Variable: Z(t) = + (1) X(t) + (0) X(t-1)
> deviance(mod.lstar_both)
         [,1]
[1,] 4.580635
> c(AIC(mod.lstar_both),BIC(mod.lstar_both))
[1] -346.4371 -319.0751
> 
> ## grid attributes
> mod.lstar3 <- lstar(log10(lynx), m=2, control=list(maxit=3000), starting.control=list(gammaInt=c(1,1000), nTh=100))
Using maximum autoregressive order for low regime: mL = 2 
Using maximum autoregressive order for high regime: mH = 2 
Using default threshold variable: thDelay=0
Performing grid search for starting values...
Starting values fixed: gamma =  871.9231 , th =  2.560424 ; SSE =  4.564989 
Optimization algorithm converged
Optimized values fixed for regime 2  : gamma =  871.9231 , th =  2.560332 ; SSE =  4.564987 
> mod.lstar3

Non linear autoregressive model

LSTAR model
Coefficients:
Low regime:
    const1     phi1.1     phi1.2 
 0.3992404  1.2466373 -0.3316956 

High regime:
    const2     phi2.1     phi2.2 
 0.7821303  0.3009462 -0.6246129 

Smoothing parameter: gamma = 871.9 

Threshold
Variable: Z(t) = + (1) X(t) + (0) X(t-1)

Value: 2.56 
> print(summary(mod.lstar3), digits=2)

Non linear autoregressive model

LSTAR model
Coefficients:
Low regime:
    const1     phi1.1     phi1.2 
 0.3992404  1.2466373 -0.3316956 

High regime:
    const2     phi2.1     phi2.2 
 0.7821303  0.3009462 -0.6246129 

Smoothing parameter: gamma = 871.9 

Threshold
Variable: Z(t) = + (1) X(t) + (0) X(t-1)

Value: 2.56 

Residuals:
   Min     1Q Median     3Q    Max 
 -0.60  -0.13   0.04   0.12   0.47 

Fit:
residuals variance = 0.04004,  AIC = -351, MAPE = 5.88%

Coefficient(s):
        Estimate  Std. Error  t value Pr(>|z|)    
const1     0.399       0.283      1.4     0.16    
phi1.1     1.247       0.144      8.7   <2e-16 ***
phi1.2    -0.332       0.097     -3.4    7e-04 ***
const2     0.782       0.346      2.3     0.02 *  
phi2.1     0.301       0.166      1.8     0.07 .  
phi2.2    -0.625       0.119     -5.2    2e-07 ***
gamma    871.923    3673.244      0.2     0.81    
th         2.560       0.010    255.2   <2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

Non-linearity test of full-order LSTAR model against full-order AR model
 F = 8.5 ; p-value = 0.00037 

Threshold 
Variable: Z(t) = + (1) X(t) + (0) X(t-1)
> deviance(mod.lstar3)
         [,1]
[1,] 4.564987
> c(AIC(mod.lstar3),BIC(mod.lstar3))
[1] -350.8272 -328.9377
> 
> proc.time()
   user  system elapsed 
  7.850   0.070   7.906 
