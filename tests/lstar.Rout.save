
R version 2.15.2 (2012-10-26) -- "Trick or Treat"
Copyright (C) 2012 The R Foundation for Statistical Computing
ISBN 3-900051-07-0
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> library(tsDyn)
> 
> mod.lstar <- lstar(log10(lynx), m=2, mTh=c(0,1), control=list(maxit=3000))
Using maximum autoregressive order for low regime: mL = 2 
Using maximum autoregressive order for high regime: mH = 2 
Performing grid search for starting values...
Starting values fixed: gamma =  11.15385 , th =  3.337486 ; SSE =  4.337664 
Optimization algorithm converged
Optimized values fixed for regime 2  : gamma =  11.15383 , th =  3.339199 ; SSE =  4.337643 
> mod.lstar

Non linear autoregressive model

LSTAR model
Coefficients:
Low regime:
    const1     phi1.1     phi1.2 
 0.4891014  1.2465399 -0.3664328 

High regime:
    const2     phi2.1     phi2.2 
-1.0240758  0.4232669 -0.2546088 

Smoothing parameter: gamma = 11.15 

Threshold
Variable: Z(t) = + (0) X(t) + (1) X(t-1)

Value: 3.339 
> summary(mod.lstar)

Non linear autoregressive model

LSTAR model
Coefficients:
Low regime:
    const1     phi1.1     phi1.2 
 0.4891014  1.2465399 -0.3664328 

High regime:
    const2     phi2.1     phi2.2 
-1.0240758  0.4232669 -0.2546088 

Smoothing parameter: gamma = 11.15 

Threshold
Variable: Z(t) = + (0) X(t) + (1) X(t-1)

Value: 3.339 

Residuals:
      Min        1Q    Median        3Q       Max 
-0.594820 -0.107360  0.014309  0.111098  0.510342 

Fit:
residuals variance = 0.03805,  AIC = -357, MAPE = 5.58%

Coefficient(s):
        Estimate  Std. Error  t value  Pr(>|z|)    
const1  0.489101    0.204915   2.3868 0.0169935 *  
phi1.1  1.246540    0.067871  18.3663 < 2.2e-16 ***
phi1.2 -0.366433    0.104301  -3.5132 0.0004427 ***
const2 -1.024076    2.430098  -0.4214 0.6734532    
phi2.1  0.423267    0.172146   2.4588 0.0139417 *  
phi2.2 -0.254609    0.585422  -0.4349 0.6636244    
gamma  11.153834   10.004786   1.1148 0.2649148    
th      3.339199    0.092749  36.0024 < 2.2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

Non-linearity test of full-order LSTAR model against full-order AR model
 F = 12.446 ; p-value = 1.3815e-05 

Threshold 
Variable: Z(t) = + (0) X(t) + (1) X(t-1)
> deviance(mod.lstar)
         [,1]
[1,] 4.337643
> c(AIC(mod.lstar),BIC(mod.lstar))
[1] -356.6509 -334.7613
> 
> mod.lstar2 <- lstar(log10(lynx), m=1, control=list(maxit=3000))
Using maximum autoregressive order for low regime: mL = 1 
Using maximum autoregressive order for high regime: mH = 1 
Using default threshold variable: thDelay=0
Performing grid search for starting values...
Starting values fixed: gamma =  100 , th =  3.23744 ; SSE =  12.59824 
Grid search selected lower/upper bound gamma (was:  1 100 ]). 
					  Might try to widen bound with arg: 'starting.control=list(gammaInt=c(1,200))'
Optimization algorithm converged
Optimized values fixed for regime 2  : gamma =  100.0031 , th =  3.235652 ; SSE =  12.59746 
> mod.lstar2

Non linear autoregressive model

LSTAR model
Coefficients:
Low regime:
   const1    phi1.1 
0.2884595 0.9280287 

High regime:
    const2     phi2.1 
-0.6726318  0.1331190 

Smoothing parameter: gamma = 100 

Threshold
Variable: Z(t) = + (1) X(t) 

Value: 3.236 
> summary(mod.lstar2)

Non linear autoregressive model

LSTAR model
Coefficients:
Low regime:
   const1    phi1.1 
0.2884595 0.9280287 

High regime:
    const2     phi2.1 
-0.6726318  0.1331190 

Smoothing parameter: gamma = 100 

Threshold
Variable: Z(t) = + (1) X(t) 

Value: 3.236 

Residuals:
      Min        1Q    Median        3Q       Max 
-1.005052 -0.130163  0.093703  0.236265  0.646672 

Fit:
residuals variance = 0.1105,  AIC = -239, MAPE = 9.965%

Coefficient(s):
         Estimate  Std. Error  t value Pr(>|z|)    
const1   0.288460    0.246037   1.1724   0.2410    
phi1.1   0.928029    0.094170   9.8549   <2e-16 ***
const2  -0.672632    1.336363  -0.5033   0.6147    
phi2.1   0.133119    0.384826   0.3459   0.7294    
gamma  100.003135   93.728975   1.0669   0.2860    
th       3.235652    0.021024 153.9038   <2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

Non-linearity test of full-order LSTAR model against full-order AR model
 F = 0.76605 ; p-value = 0.38335 

Threshold 
Variable: Z(t) = + (1) X(t) 
> deviance(mod.lstar2)
         [,1]
[1,] 12.59746
> c(AIC(mod.lstar2),BIC(mod.lstar2))
[1] -239.1082 -222.6910
> 
> ## include: none
> mod.lstar_noConst <- lstar(log10(lynx), m=2, control=list(maxit=1000), include="none")
Using maximum autoregressive order for low regime: mL = 2 
Using maximum autoregressive order for high regime: mH = 2 
Using default threshold variable: thDelay=0
Performing grid search for starting values...
Starting values fixed: gamma =  3.538462 , th =  2.719919 ; SSE =  4.933078 
Optimization algorithm converged
Optimized values fixed for regime 2  : gamma =  2.456908 , th =  2.707843 ; SSE =  4.907455 
> mod.lstar_noConst

Non linear autoregressive model

LSTAR model
Coefficients:
Low regime:
    phi1.1     phi1.2 
 1.4005126 -0.2253725 

High regime:
    phi2.1     phi2.2 
 0.7660504 -1.0552844 

Smoothing parameter: gamma = 2.457 

Threshold
Variable: Z(t) = + (1) X(t) + (0) X(t-1)

Value: 2.708 
> summary(mod.lstar_noConst)

Non linear autoregressive model

LSTAR model
Coefficients:
Low regime:
    phi1.1     phi1.2 
 1.4005126 -0.2253725 

High regime:
    phi2.1     phi2.2 
 0.7660504 -1.0552844 

Smoothing parameter: gamma = 2.457 

Threshold
Variable: Z(t) = + (1) X(t) + (0) X(t-1)

Value: 2.708 

Residuals:
      Min        1Q    Median        3Q       Max 
-0.576970 -0.134178  0.025047  0.147316  0.508265 

Fit:
residuals variance = 0.04305,  AIC = -347, MAPE = 6.175%

Coefficient(s):
        Estimate  Std. Error  t value  Pr(>|z|)    
phi1.1   1.40051     0.17405   8.0465 8.882e-16 ***
phi1.2  -0.22537     0.21245  -1.0608  0.288778    
phi2.1   0.76605     0.31698   2.4167  0.015661 *  
phi2.2  -1.05528     0.38300  -2.7553  0.005863 ** 
gamma    2.45691     1.31198   1.8727  0.061114 .  
th       2.70784     0.15801  17.1375 < 2.2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

Non-linearity test of full-order LSTAR model against full-order AR model
 F = 8.529 ; p-value = 0.00036569 

Threshold 
Variable: Z(t) = + (1) X(t) + (0) X(t-1)
> deviance(mod.lstar_noConst)
         [,1]
[1,] 4.907455
> c(AIC(mod.lstar_noConst),BIC(mod.lstar_noConst))
[1] -346.5805 -330.1633
> 
> ## include: trend
> mod.lstar_trend <- lstar(log10(lynx), m=2, control=list(maxit=1000), include="trend")
Using maximum autoregressive order for low regime: mL = 2 
Using maximum autoregressive order for high regime: mH = 2 
Using default threshold variable: thDelay=0
Performing grid search for starting values...
Starting values fixed: gamma =  3.538462 , th =  2.712901 ; SSE =  4.899802 
Optimization algorithm converged
Optimized values fixed for regime 2  : gamma =  2.575672 , th =  2.697974 ; SSE =  4.880102 
> mod.lstar_trend

Non linear autoregressive model

LSTAR model
Coefficients:
Low regime:
       trend1        phi1.1        phi1.2 
 1.825193e-05  1.403688e+00 -2.333263e-01 

High regime:
       trend2        phi2.1        phi2.2 
 0.0006932109  0.7390089035 -1.0305204430 

Smoothing parameter: gamma = 2.576 

Threshold
Variable: Z(t) = + (1) X(t) + (0) X(t-1)

Value: 2.698 
> summary(mod.lstar_trend)

Non linear autoregressive model

LSTAR model
Coefficients:
Low regime:
       trend1        phi1.1        phi1.2 
 1.825193e-05  1.403688e+00 -2.333263e-01 

High regime:
       trend2        phi2.1        phi2.2 
 0.0006932109  0.7390089035 -1.0305204430 

Smoothing parameter: gamma = 2.576 

Threshold
Variable: Z(t) = + (1) X(t) + (0) X(t-1)

Value: 2.698 

Residuals:
      Min        1Q    Median        3Q       Max 
-0.596707 -0.132155  0.024022  0.143877  0.521332 

Fit:
residuals variance = 0.04281,  AIC = -343, MAPE = 6.137%

Coefficient(s):
          Estimate  Std. Error  t value  Pr(>|z|)    
trend1  1.8252e-05  1.6342e-03   0.0112  0.991089    
phi1.1  1.4037e+00  1.6546e-01   8.4833 < 2.2e-16 ***
phi1.2 -2.3333e-01  2.1022e-01  -1.1099  0.267047    
trend2  6.9321e-04  2.3867e-03   0.2904  0.771473    
phi2.1  7.3901e-01  2.9735e-01   2.4853  0.012945 *  
phi2.2 -1.0305e+00  3.5984e-01  -2.8639  0.004185 ** 
gamma   2.5757e+00  1.3490e+00   1.9094  0.056213 .  
th      2.6980e+00  1.6637e-01  16.2169 < 2.2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

Non-linearity test of full-order LSTAR model against full-order AR model
 F = 8.529 ; p-value = 0.00036569 

Threshold 
Variable: Z(t) = + (1) X(t) + (0) X(t-1)
> deviance(mod.lstar_trend)
         [,1]
[1,] 4.880102
> c(AIC(mod.lstar_trend),BIC(mod.lstar_trend))
[1] -343.2177 -321.3281
> 
> ## include: both
> mod.lstar_both <- lstar(log10(lynx), m=2, control=list(maxit=1000), include="both")
Using maximum autoregressive order for low regime: mL = 2 
Using maximum autoregressive order for high regime: mH = 2 
Using default threshold variable: thDelay=0
Performing grid search for starting values...
Starting values fixed: gamma =  100 , th =  2.565527 ; SSE =  4.581837 
Grid search selected lower/upper bound gamma (was:  1 100 ]). 
					  Might try to widen bound with arg: 'starting.control=list(gammaInt=c(1,200))'
Optimization algorithm converged
Optimized values fixed for regime 2  : gamma =  100.0001 , th =  2.568063 ; SSE =  4.580635 
> mod.lstar_both

Non linear autoregressive model

LSTAR model
Coefficients:
Low regime:
       const1        trend1        phi1.1        phi1.2 
 0.3869417359  0.0002595822  1.2409824738 -0.3277026131 

High regime:
       const2        trend2        phi2.1        phi2.2 
 0.7981219886  0.0001995693  0.3034500606 -0.6346479944 

Smoothing parameter: gamma = 100 

Threshold
Variable: Z(t) = + (1) X(t) + (0) X(t-1)

Value: 2.568 
> summary(mod.lstar_both)

Non linear autoregressive model

LSTAR model
Coefficients:
Low regime:
       const1        trend1        phi1.1        phi1.2 
 0.3869417359  0.0002595822  1.2409824738 -0.3277026131 

High regime:
       const2        trend2        phi2.1        phi2.2 
 0.7981219886  0.0001995693  0.3034500606 -0.6346479944 

Smoothing parameter: gamma = 100 

Threshold
Variable: Z(t) = + (1) X(t) + (0) X(t-1)

Value: 2.568 

Residuals:
      Min        1Q    Median        3Q       Max 
-0.587125 -0.120256  0.041373  0.132314  0.487811 

Fit:
residuals variance = 0.04018,  AIC = -346, MAPE = 5.915%

Coefficient(s):
          Estimate  Std. Error  t value  Pr(>|z|)    
const1  3.8694e-01  3.1768e-01   1.2180 0.2232142    
trend1  2.5958e-04  1.3092e-03   0.1983 0.8428239    
phi1.1  1.2410e+00  1.5052e-01   8.2444 2.220e-16 ***
phi1.2 -3.2770e-01  9.8629e-02  -3.3226 0.0008919 ***
const2  7.9812e-01  3.7117e-01   2.1503 0.0315332 *  
trend2  1.9957e-04  1.4824e-03   0.1346 0.8929096    
phi2.1  3.0345e-01  1.7018e-01   1.7831 0.0745682 .  
phi2.2 -6.3465e-01  1.2179e-01  -5.2110 1.879e-07 ***
gamma   1.0000e+02  8.0618e+01   1.2404 0.2148216    
th      2.5681e+00  1.4783e-02 173.7186 < 2.2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

Non-linearity test of full-order LSTAR model against full-order AR model
 F = 8.529 ; p-value = 0.00036569 

Threshold 
Variable: Z(t) = + (1) X(t) + (0) X(t-1)
> deviance(mod.lstar_both)
         [,1]
[1,] 4.580635
> c(AIC(mod.lstar_both),BIC(mod.lstar_both))
[1] -346.4371 -319.0751
> 
> ## grid attributes
> mod.lstar3 <- lstar(log10(lynx), m=2, control=list(maxit=3000), starting.control=list(gammaInt=c(1,1000), nTh=100))
Using maximum autoregressive order for low regime: mL = 2 
Using maximum autoregressive order for high regime: mH = 2 
Using default threshold variable: thDelay=0
Performing grid search for starting values...
Starting values fixed: gamma =  871.9231 , th =  2.560424 ; SSE =  4.564989 
Optimization algorithm converged
Optimized values fixed for regime 2  : gamma =  871.9231 , th =  2.560332 ; SSE =  4.564987 
> mod.lstar3

Non linear autoregressive model

LSTAR model
Coefficients:
Low regime:
    const1     phi1.1     phi1.2 
 0.3992404  1.2466373 -0.3316956 

High regime:
    const2     phi2.1     phi2.2 
 0.7821303  0.3009462 -0.6246129 

Smoothing parameter: gamma = 871.9 

Threshold
Variable: Z(t) = + (1) X(t) + (0) X(t-1)

Value: 2.56 
> summary(mod.lstar3)

Non linear autoregressive model

LSTAR model
Coefficients:
Low regime:
    const1     phi1.1     phi1.2 
 0.3992404  1.2466373 -0.3316956 

High regime:
    const2     phi2.1     phi2.2 
 0.7821303  0.3009462 -0.6246129 

Smoothing parameter: gamma = 871.9 

Threshold
Variable: Z(t) = + (1) X(t) + (0) X(t-1)

Value: 2.56 

Residuals:
      Min        1Q    Median        3Q       Max 
-0.596125 -0.126653  0.039972  0.118475  0.474407 

Fit:
residuals variance = 0.04004,  AIC = -351, MAPE = 5.88%

Coefficient(s):
          Estimate  Std. Error  t value  Pr(>|z|)    
const1    0.399240    0.283236   1.4096 0.1586673    
phi1.1    1.246637    0.144031   8.6553 < 2.2e-16 ***
phi1.2   -0.331696    0.097462  -3.4033 0.0006657 ***
const2    0.782130    0.346259   2.2588 0.0238956 *  
phi2.1    0.300946    0.165911   1.8139 0.0696928 .  
phi2.2   -0.624613    0.119007  -5.2485 1.533e-07 ***
gamma   871.923077 3818.880366   0.2283 0.8193982    
th        2.560332    0.010230 250.2826 < 2.2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

Non-linearity test of full-order LSTAR model against full-order AR model
 F = 8.529 ; p-value = 0.00036569 

Threshold 
Variable: Z(t) = + (1) X(t) + (0) X(t-1)
> deviance(mod.lstar3)
         [,1]
[1,] 4.564987
> c(AIC(mod.lstar3),BIC(mod.lstar3))
[1] -350.8272 -328.9377
> 
> proc.time()
   user  system elapsed 
  7.850   0.070   7.906 
