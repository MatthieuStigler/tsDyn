
R version 2.14.1 (2011-12-22)
Copyright (C) 2011 The R Foundation for Statistical Computing
ISBN 3-900051-07-0
Platform: x86_64-pc-linux-gnu (64-bit)

R est un logiciel libre livré sans AUCUNE GARANTIE.
Vous pouvez le redistribuer sous certaines conditions.
Tapez 'license()' ou 'licence()' pour plus de détails.

R est un projet collaboratif avec de nombreux contributeurs.
Tapez 'contributors()' pour plus d'information et
'citation()' pour la façon de le citer dans les publications.

Tapez 'demo()' pour des démonstrations, 'help()' pour l'aide
en ligne ou 'help.start()' pour obtenir l'aide au format HTML.
Tapez 'q()' pour quitter R.

REvolution R enhancements not installed.  For improved
performance and other extensions: apt-get install revolution-r

> library(tsDyn)
Loading required package: mgcv
This is mgcv 1.7-6. For overview type 'help("mgcv-package")'.
Loading required package: Matrix
Loading required package: lattice

Attaching package: 'Matrix'

The following object(s) are masked from 'package:base':

    det

Loading required package: snow

Attaching package: 'snow'

The following object(s) are masked from 'package:base':

    enquote

Loading required package: mnormt
Loading required package: foreach
Loading required package: iterators
Loading required package: codetools
Loading required package: MASS
Loading required package: nlme
> 
> mod.lstar <- lstar(log10(lynx), m=2, mTh=c(0,1), control=list(maxit=3000))
Using maximum autoregressive order for low regime: mL = 2 
Using maximum autoregressive order for high regime: mH = 2 
Performing grid search for starting values...
Starting values fixed: gamma =  11.15385 , th =  3.338679 ; SSE =  4.337645 
Optimization algorithm converged
Optimized values fixed for regime 2  : gamma =  11.15383 , th =  3.339194 ; SSE =  4.337643 
> mod.lstar

Non linear autoregressive model

LSTAR model
Coefficients:
Low regime:
    const1     phi1.1     phi1.2 
 0.4890997  1.2465393 -0.3664314 

High regime:
    const2     phi2.1     phi2.2 
-1.0240190  0.4232653 -0.2546230 

Smoothing parameter: gamma = 11.15 

Threshold
Variable: Z(t) = + (0) X(t) + (1) X(t-1)

Value: 3.339 
> summary(mod.lstar)

Non linear autoregressive model

LSTAR model
Coefficients:
Low regime:
    const1     phi1.1     phi1.2 
 0.4890997  1.2465393 -0.3664314 

High regime:
    const2     phi2.1     phi2.2 
-1.0240190  0.4232653 -0.2546230 

Smoothing parameter: gamma = 11.15 

Threshold
Variable: Z(t) = + (0) X(t) + (1) X(t-1)

Value: 3.339 

Residuals:
     Min       1Q   Median       3Q      Max 
-0.59482 -0.10736  0.01431  0.11110  0.51034 

Fit:
residuals variance = 0.03805,  AIC = -357, MAPE = 5.58%

Coefficient(s):
        Estimate  Std. Error  t value  Pr(>|z|)    
const1  0.489100    0.204911   2.3869 0.0169915 *  
phi1.1  1.246539    0.067871  18.3662 < 2.2e-16 ***
phi1.2 -0.366431    0.104300  -3.5133 0.0004427 ***
const2 -1.024019    2.429946  -0.4214 0.6734510    
phi2.1  0.423265    0.172143   2.4588 0.0139402 *  
phi2.2 -0.254623    0.585392  -0.4350 0.6635901    
gamma  11.153826   10.004097   1.1149 0.2648822    
th      3.339194    0.092745  36.0040 < 2.2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

Non-linearity test of full-order LSTAR model against full-order AR model
 F = 12.446 ; p-value = 1.3815e-05 

Threshold 
Variable: Z(t) = + (0) X(t) + (1) X(t-1)
> deviance(mod.lstar)
         [,1]
[1,] 4.337643
> c(AIC(mod.lstar),BIC(mod.lstar))
[1] -356.6509 -334.7613
> 
> mod.lstar2 <- lstar(log10(lynx), m=1, control=list(maxit=3000))
Using maximum autoregressive order for low regime: mL = 1 
Using maximum autoregressive order for high regime: mH = 1 
Using default threshold variable: thDelay=0
Performing grid search for starting values...
Starting values fixed: gamma =  100 , th =  3.239121 ; SSE =  12.60051 
Grid search selected lower/upper bound gamma (default [1,100]). 
					  Might try to widen bound with arg: 'starting.control=list(gammaInt=c(1,200))'
Optimization algorithm converged
Optimized values fixed for regime 2  : gamma =  100.0033 , th =  3.235707 ; SSE =  12.59746 
> mod.lstar2

Non linear autoregressive model

LSTAR model
Coefficients:
Low regime:
   const1    phi1.1 
0.2884627 0.9280240 

High regime:
    const2     phi2.1 
-0.6726576  0.1331259 

Smoothing parameter: gamma = 100 

Threshold
Variable: Z(t) = + (1) X(t) 

Value: 3.236 
> summary(mod.lstar2)

Non linear autoregressive model

LSTAR model
Coefficients:
Low regime:
   const1    phi1.1 
0.2884627 0.9280240 

High regime:
    const2     phi2.1 
-0.6726576  0.1331259 

Smoothing parameter: gamma = 100 

Threshold
Variable: Z(t) = + (1) X(t) 

Value: 3.236 

Residuals:
      Min        1Q    Median        3Q       Max 
-1.005042 -0.130153  0.093713  0.236273  0.646682 

Fit:
residuals variance = 0.1105,  AIC = -239, MAPE = 9.965%

Coefficient(s):
         Estimate  Std. Error  t value Pr(>|z|)    
const1   0.288463    0.246037   1.1724   0.2410    
phi1.1   0.928024    0.094170   9.8548   <2e-16 ***
const2  -0.672658    1.336384  -0.5033   0.6147    
phi2.1   0.133126    0.384832   0.3459   0.7294    
gamma  100.003286   93.735519   1.0669   0.2860    
th       3.235707    0.021025 153.8994   <2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

Non-linearity test of full-order LSTAR model against full-order AR model
 F = 0.76605 ; p-value = 0.38335 

Threshold 
Variable: Z(t) = + (1) X(t) 
> deviance(mod.lstar2)
         [,1]
[1,] 12.59746
> c(AIC(mod.lstar2),BIC(mod.lstar2))
[1] -239.1082 -222.6910
> 
> ## include: none
> mod.lstar_noConst <- lstar(log10(lynx), m=2, control=list(maxit=1000), include="none")
Using maximum autoregressive order for low regime: mL = 2 
Using maximum autoregressive order for high regime: mH = 2 
Using default threshold variable: thDelay=0
Performing grid search for starting values...
Starting values fixed: gamma =  3.538462 , th =  2.717217 ; SSE =  4.933124 
Optimization algorithm converged
Optimized values fixed for regime 2  : gamma =  2.474218 , th =  2.708203 ; SSE =  4.90745 
> mod.lstar_noConst

Non linear autoregressive model

LSTAR model
Coefficients:
Low regime:
    phi1.1     phi1.2 
 1.4019861 -0.2275385 

High regime:
    phi2.1     phi2.2 
 0.7632842 -1.0512554 

Smoothing parameter: gamma = 2.474 

Threshold
Variable: Z(t) = + (1) X(t) + (0) X(t-1)

Value: 2.708 
> summary(mod.lstar_noConst)

Non linear autoregressive model

LSTAR model
Coefficients:
Low regime:
    phi1.1     phi1.2 
 1.4019861 -0.2275385 

High regime:
    phi2.1     phi2.2 
 0.7632842 -1.0512554 

Smoothing parameter: gamma = 2.474 

Threshold
Variable: Z(t) = + (1) X(t) + (0) X(t-1)

Value: 2.708 

Residuals:
      Min        1Q    Median        3Q       Max 
-0.577313 -0.134008  0.025054  0.146881  0.508190 

Fit:
residuals variance = 0.04305,  AIC = -347, MAPE = 6.175%

Coefficient(s):
        Estimate  Std. Error  t value  Pr(>|z|)    
phi1.1   1.40199     0.17240   8.1320 4.441e-16 ***
phi1.2  -0.22754     0.20992  -1.0839  0.278403    
phi2.1   0.76328     0.31383   2.4321  0.015010 *  
phi2.2  -1.05126     0.37833  -2.7787  0.005458 ** 
gamma    2.47422     1.30664   1.8936  0.058282 .  
th       2.70820     0.15698  17.2522 < 2.2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

Non-linearity test of full-order LSTAR model against full-order AR model
 F = 8.529 ; p-value = 0.00036569 

Threshold 
Variable: Z(t) = + (1) X(t) + (0) X(t-1)
> deviance(mod.lstar_noConst)
        [,1]
[1,] 4.90745
> c(AIC(mod.lstar_noConst),BIC(mod.lstar_noConst))
[1] -346.5806 -330.1634
> 
> ## include: trend
> mod.lstar_trend <- lstar(log10(lynx), m=2, control=list(maxit=1000), include="trend")
Using maximum autoregressive order for low regime: mL = 2 
Using maximum autoregressive order for high regime: mH = 2 
Using default threshold variable: thDelay=0
Performing grid search for starting values...
Starting values fixed: gamma =  3.538462 , th =  2.717217 ; SSE =  4.899765 
Optimization algorithm converged
Optimized values fixed for regime 2  : gamma =  2.562222 , th =  2.697521 ; SSE =  4.8801 
> mod.lstar_trend

Non linear autoregressive model

LSTAR model
Coefficients:
Low regime:
       trend1        phi1.1        phi1.2 
 1.458266e-05  1.402670e+00 -2.317046e-01 

High regime:
      trend2       phi2.1       phi2.2 
 0.000697941  0.740846551 -1.033365399 

Smoothing parameter: gamma = 2.562 

Threshold
Variable: Z(t) = + (1) X(t) + (0) X(t-1)

Value: 2.698 
> summary(mod.lstar_trend)

Non linear autoregressive model

LSTAR model
Coefficients:
Low regime:
       trend1        phi1.1        phi1.2 
 1.458266e-05  1.402670e+00 -2.317046e-01 

High regime:
      trend2       phi2.1       phi2.2 
 0.000697941  0.740846551 -1.033365399 

Smoothing parameter: gamma = 2.562 

Threshold
Variable: Z(t) = + (1) X(t) + (0) X(t-1)

Value: 2.698 

Residuals:
      Min        1Q    Median        3Q       Max 
-0.596556 -0.132002  0.023903  0.144016  0.521340 

Fit:
residuals variance = 0.04281,  AIC = -343, MAPE = 6.137%

Coefficient(s):
          Estimate  Std. Error  t value  Pr(>|z|)    
trend1  1.4583e-05  1.6391e-03   0.0089  0.992902    
phi1.1  1.4027e+00  1.6679e-01   8.4098 < 2.2e-16 ***
phi1.2 -2.3170e-01  2.1245e-01  -1.0906  0.275445    
trend2  6.9794e-04  2.3951e-03   0.2914  0.770745    
phi2.1  7.4085e-01  2.9975e-01   2.4716  0.013453 *  
phi2.2 -1.0334e+00  3.6366e-01  -2.8416  0.004489 ** 
gamma   2.5622e+00  1.3528e+00   1.8940  0.058219 .  
th      2.6975e+00  1.6752e-01  16.1027 < 2.2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

Non-linearity test of full-order LSTAR model against full-order AR model
 F = 8.529 ; p-value = 0.00036569 

Threshold 
Variable: Z(t) = + (1) X(t) + (0) X(t-1)
> deviance(mod.lstar_trend)
       [,1]
[1,] 4.8801
> c(AIC(mod.lstar_trend),BIC(mod.lstar_trend))
[1] -343.2177 -321.3281
> 
> ## include: both
> mod.lstar_both <- lstar(log10(lynx), m=2, control=list(maxit=1000), include="both")
Using maximum autoregressive order for low regime: mL = 2 
Using maximum autoregressive order for high regime: mH = 2 
Using default threshold variable: thDelay=0
Performing grid search for starting values...
Starting values fixed: gamma =  100 , th =  2.57058 ; SSE =  4.581802 
Grid search selected lower/upper bound gamma (default [1,100]). 
					  Might try to widen bound with arg: 'starting.control=list(gammaInt=c(1,200))'
Optimization algorithm converged
Optimized values fixed for regime 2  : gamma =  100.0001 , th =  2.568066 ; SSE =  4.580635 
> mod.lstar_both

Non linear autoregressive model

LSTAR model
Coefficients:
Low regime:
       const1        trend1        phi1.1        phi1.2 
 0.3869414345  0.0002595805  1.2409824371 -0.3277023964 

High regime:
       const2        trend2        phi2.1        phi2.2 
 0.7981223405  0.0001995712  0.3034499272 -0.6346480539 

Smoothing parameter: gamma = 100 

Threshold
Variable: Z(t) = + (1) X(t) + (0) X(t-1)

Value: 2.568 
> summary(mod.lstar_both)

Non linear autoregressive model

LSTAR model
Coefficients:
Low regime:
       const1        trend1        phi1.1        phi1.2 
 0.3869414345  0.0002595805  1.2409824371 -0.3277023964 

High regime:
       const2        trend2        phi2.1        phi2.2 
 0.7981223405  0.0001995712  0.3034499272 -0.6346480539 

Smoothing parameter: gamma = 100 

Threshold
Variable: Z(t) = + (1) X(t) + (0) X(t-1)

Value: 2.568 

Residuals:
      Min        1Q    Median        3Q       Max 
-0.587125 -0.120256  0.041373  0.132314  0.487811 

Fit:
residuals variance = 0.04018,  AIC = -346, MAPE = 5.915%

Coefficient(s):
          Estimate  Std. Error  t value  Pr(>|z|)    
const1  3.8694e-01  3.1768e-01   1.2180 0.2232146    
trend1  2.5958e-04  1.3092e-03   0.1983 0.8428249    
phi1.1  1.2410e+00  1.5052e-01   8.2444 2.220e-16 ***
phi1.2 -3.2770e-01  9.8629e-02  -3.3226 0.0008919 ***
const2  7.9812e-01  3.7117e-01   2.1503 0.0315331 *  
trend2  1.9957e-04  1.4824e-03   0.1346 0.8929087    
phi2.1  3.0345e-01  1.7018e-01   1.7831 0.0745683 .  
phi2.2 -6.3465e-01  1.2179e-01  -5.2110 1.879e-07 ***
gamma   1.0000e+02  8.0618e+01   1.2404 0.2148216    
th      2.5681e+00  1.4783e-02 173.7188 < 2.2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

Non-linearity test of full-order LSTAR model against full-order AR model
 F = 8.529 ; p-value = 0.00036569 

Threshold 
Variable: Z(t) = + (1) X(t) + (0) X(t-1)
> deviance(mod.lstar_both)
         [,1]
[1,] 4.580635
> c(AIC(mod.lstar_both),BIC(mod.lstar_both))
[1] -346.4371 -319.0751
> 
> ## grid attributes
> mod.lstar3 <- lstar(log10(lynx), m=2, control=list(maxit=3000), starting.control=list(gammaInt=c(1,1000), nTh=100))
Using maximum autoregressive order for low regime: mL = 2 
Using maximum autoregressive order for high regime: mH = 2 
Using default threshold variable: thDelay=0
Performing grid search for starting values...
Starting values fixed: gamma =  871.9231 , th =  2.560424 ; SSE =  4.564989 
Optimization algorithm converged
Optimized values fixed for regime 2  : gamma =  871.9231 , th =  2.560332 ; SSE =  4.564987 
> mod.lstar3

Non linear autoregressive model

LSTAR model
Coefficients:
Low regime:
    const1     phi1.1     phi1.2 
 0.3992404  1.2466373 -0.3316956 

High regime:
    const2     phi2.1     phi2.2 
 0.7821303  0.3009462 -0.6246129 

Smoothing parameter: gamma = 871.9 

Threshold
Variable: Z(t) = + (1) X(t) + (0) X(t-1)

Value: 2.56 
> summary(mod.lstar3)

Non linear autoregressive model

LSTAR model
Coefficients:
Low regime:
    const1     phi1.1     phi1.2 
 0.3992404  1.2466373 -0.3316956 

High regime:
    const2     phi2.1     phi2.2 
 0.7821303  0.3009462 -0.6246129 

Smoothing parameter: gamma = 871.9 

Threshold
Variable: Z(t) = + (1) X(t) + (0) X(t-1)

Value: 2.56 

Residuals:
      Min        1Q    Median        3Q       Max 
-0.596125 -0.126653  0.039972  0.118475  0.474407 

Fit:
residuals variance = 0.04004,  AIC = -351, MAPE = 5.88%

Coefficient(s):
          Estimate  Std. Error  t value  Pr(>|z|)    
const1    0.399240    0.283183   1.4098 0.1585895    
phi1.1    1.246637    0.144031   8.6553 < 2.2e-16 ***
phi1.2   -0.331696    0.097428  -3.4045 0.0006628 ***
const2    0.782130    0.346191   2.2592 0.0238681 *  
phi2.1    0.300946    0.165911   1.8139 0.0696923 .  
phi2.2   -0.624613    0.118978  -5.2498 1.523e-07 ***
gamma   871.923077 3673.244447   0.2374 0.8123687    
th        2.560332    0.010033 255.1885 < 2.2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

Non-linearity test of full-order LSTAR model against full-order AR model
 F = 8.529 ; p-value = 0.00036569 

Threshold 
Variable: Z(t) = + (1) X(t) + (0) X(t-1)
> deviance(mod.lstar3)
         [,1]
[1,] 4.564987
> c(AIC(mod.lstar3),BIC(mod.lstar3))
[1] -350.8272 -328.9377
> 
> proc.time()
   user  system elapsed 
  7.850   0.070   7.906 
