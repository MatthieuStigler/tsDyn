
R version 3.5.2 (2018-12-20) -- "Eggshell Igloo"
Copyright (C) 2018 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> 
> library(tsDyn)
> suppressMessages(library(tidyverse))
> 
> ############################
> ### Load data
> ############################
> path_mod_uni <- system.file("inst/testdata/models_univariate.rds", package = "tsDyn")
> if(path_mod_uni=="") path_mod_uni <- system.file("testdata/models_univariate.rds", package = "tsDyn")
> 
> path_mod_multi <- system.file("inst/testdata/models_multivariate.rds", package = "tsDyn")
> if(path_mod_multi=="") path_mod_multi <- system.file("testdata/models_multivariate.rds", package = "tsDyn")
> 
> models_ar_setar <- readRDS(path_mod_uni) %>% 
+   filter(model %in% c("ar", "setar"))
> 
> models_multivariate <- readRDS(path_mod_multi)
> 
> ############################
> ### Univariate
> ############################
> 
> 
> mod_1_uni <- models_ar_setar$object[[1]]
> 
> tsDyn:::irf_1_shock(mod_1_uni, 
+                     shock = 1,
+                     hist = 0,
+                     seed = 123)
   var n.ahead    sim_1    sim_2
2   lh       0 2.996618 1.996618
3   lh       1 2.155985 1.628571
4   lh       2 1.664436 2.461223
5   lh       3 3.650510 3.025997
6   lh       4 3.101592 2.772216
7   lh       5 2.823117 2.649399
8   lh       6 2.720745 2.629123
9   lh       7 1.983854 1.935531
10  lh       8 1.560084 1.534598
11  lh       9 2.506257 2.483755
12  lh      10 2.696483 2.684616
> 
> tsDyn:::irf_1_shock_ave(object = mod_1_uni, 
+                         shock = 1,
+                         hist = 0, 
+                         seed = 123)
   n.ahead var    sim_1    sim_2
1        0  lh 2.582907 1.582907
2        1  lh 2.210436 2.401578
3        2  lh 2.197381 2.069223
4        3  lh 2.206660 2.134592
5        4  lh 2.329506 2.495165
6        5  lh 2.289183 2.374908
7        6  lh 2.326796 2.287624
8        7  lh 2.246429 2.226256
9        8  lh 2.188593 2.164275
10       9  lh 2.104389 2.091320
11      10  lh 2.232873 2.225188
> 
> 
> GIRF(object = mod_1_uni, 
+      hist_li = list(rep(1.6, 1)),
+      shock_li = list(0.01), 
+      R = 20, 
+      seed = 123) %>% head
  n_simu hist_l1 shock_var1 n.ahead var    sim_1    sim_2         girf
1      1     1.6       0.01       0  lh 2.893118 2.883118 0.0100000000
2      1     1.6       0.01       1  lh 2.433480 2.428206 0.0052741426
3      1     1.6       0.01       2  lh 2.065164 2.062289 0.0028754051
4      1     1.6       0.01       3  lh 2.207237 2.205424 0.0018131909
5      1     1.6       0.01       4  lh 2.318310 2.317171 0.0011388434
6      1     1.6       0.01       5  lh 2.381520 2.380841 0.0006786801
> 
> 
> ## Simple, given shocks
> models_ar_setar %>% 
+   head(2) %>% 
+   mutate(girf = map2(object, lag, ~GIRF(object=.x, n.ahead = 3,
+                                         hist_li = list(rep(1.6, .y)),
+                                         shock_li = list(0.01), R = 20, seed = 123) %>% as_tibble)) %>% 
+   unnest(girf) %>% 
+   as.data.frame()
  lag include model nthresh thDelay n_simu hist_l1 shock_var1 n.ahead var
1   1    both setar       1       0      1     1.6       0.01       0  lh
2   1    both setar       1       0      1     1.6       0.01       1  lh
3   1    both setar       1       0      1     1.6       0.01       2  lh
4   1    both setar       1       0      1     1.6       0.01       3  lh
5   1    both setar       2       0      1     1.6       0.01       0  lh
6   1    both setar       2       0      1     1.6       0.01       1  lh
7   1    both setar       2       0      1     1.6       0.01       2  lh
8   1    both setar       2       0      1     1.6       0.01       3  lh
     sim_1    sim_2        girf
1 2.923388 2.913388 0.010000000
2 2.376632 2.371358 0.005274143
3 1.967913 1.965131 0.002781658
4 2.193045 2.191281 0.001763747
5 2.744994 2.734994 0.010000000
6 2.622677 2.613671 0.009005873
7 2.307350 2.299335 0.008014439
8 2.254976 2.225508 0.029467997
> 
> ## Simple, random
> models_ar_setar %>% 
+   head(2) %>% 
+   mutate(girf = map(object, ~GIRF(object=., n.ahead = 3, n.hist = 3, n.shock = 3,
+                                   R = 20, seed = 123) %>% as_tibble)) %>% 
+   unnest(girf) %>% 
+   as.data.frame()
   lag include model nthresh thDelay n_simu hist_l1 shock_var1 n.ahead var
1    1    both setar       1       0      1     1.8  0.6035682       0  lh
2    1    both setar       1       0      1     1.8  0.6035682       1  lh
3    1    both setar       1       0      1     1.8  0.6035682       2  lh
4    1    both setar       1       0      1     1.8  0.6035682       3  lh
5    1    both setar       1       0      2     1.4  0.6035682       0  lh
6    1    both setar       1       0      2     1.4  0.6035682       1  lh
7    1    both setar       1       0      2     1.4  0.6035682       2  lh
8    1    both setar       1       0      2     1.4  0.6035682       3  lh
9    1    both setar       1       0      3     1.9  0.6035682       0  lh
10   1    both setar       1       0      3     1.9  0.6035682       1  lh
11   1    both setar       1       0      3     1.9  0.6035682       2  lh
12   1    both setar       1       0      3     1.9  0.6035682       3  lh
13   1    both setar       1       0      4     1.8  0.5690856       0  lh
14   1    both setar       1       0      4     1.8  0.5690856       1  lh
15   1    both setar       1       0      4     1.8  0.5690856       2  lh
16   1    both setar       1       0      4     1.8  0.5690856       3  lh
17   1    both setar       1       0      5     1.4  0.5690856       0  lh
18   1    both setar       1       0      5     1.4  0.5690856       1  lh
19   1    both setar       1       0      5     1.4  0.5690856       2  lh
20   1    both setar       1       0      5     1.4  0.5690856       3  lh
21   1    both setar       1       0      6     1.9  0.5690856       0  lh
22   1    both setar       1       0      6     1.9  0.5690856       1  lh
23   1    both setar       1       0      6     1.9  0.5690856       2  lh
24   1    both setar       1       0      6     1.9  0.5690856       3  lh
25   1    both setar       1       0      7     1.8 -0.1653949       0  lh
26   1    both setar       1       0      7     1.8 -0.1653949       1  lh
27   1    both setar       1       0      7     1.8 -0.1653949       2  lh
28   1    both setar       1       0      7     1.8 -0.1653949       3  lh
29   1    both setar       1       0      8     1.4 -0.1653949       0  lh
30   1    both setar       1       0      8     1.4 -0.1653949       1  lh
31   1    both setar       1       0      8     1.4 -0.1653949       2  lh
32   1    both setar       1       0      8     1.4 -0.1653949       3  lh
33   1    both setar       1       0      9     1.9 -0.1653949       0  lh
34   1    both setar       1       0      9     1.9 -0.1653949       1  lh
35   1    both setar       1       0      9     1.9 -0.1653949       2  lh
36   1    both setar       1       0      9     1.9 -0.1653949       3  lh
37   1    both setar       2       0      1     1.8  0.9648504       0  lh
38   1    both setar       2       0      1     1.8  0.9648504       1  lh
39   1    both setar       2       0      1     1.8  0.9648504       2  lh
40   1    both setar       2       0      1     1.8  0.9648504       3  lh
41   1    both setar       2       0      2     1.4  0.9648504       0  lh
42   1    both setar       2       0      2     1.4  0.9648504       1  lh
43   1    both setar       2       0      2     1.4  0.9648504       2  lh
44   1    both setar       2       0      2     1.4  0.9648504       3  lh
45   1    both setar       2       0      3     1.9  0.9648504       0  lh
46   1    both setar       2       0      3     1.9  0.9648504       1  lh
47   1    both setar       2       0      3     1.9  0.9648504       2  lh
48   1    both setar       2       0      3     1.9  0.9648504       3  lh
49   1    both setar       2       0      4     1.8  0.3116402       0  lh
50   1    both setar       2       0      4     1.8  0.3116402       1  lh
51   1    both setar       2       0      4     1.8  0.3116402       2  lh
52   1    both setar       2       0      4     1.8  0.3116402       3  lh
53   1    both setar       2       0      5     1.4  0.3116402       0  lh
54   1    both setar       2       0      5     1.4  0.3116402       1  lh
55   1    both setar       2       0      5     1.4  0.3116402       2  lh
56   1    both setar       2       0      5     1.4  0.3116402       3  lh
57   1    both setar       2       0      6     1.9  0.3116402       0  lh
58   1    both setar       2       0      6     1.9  0.3116402       1  lh
59   1    both setar       2       0      6     1.9  0.3116402       2  lh
60   1    both setar       2       0      6     1.9  0.3116402       3  lh
61   1    both setar       2       0      7     1.8 -0.1519284       0  lh
62   1    both setar       2       0      7     1.8 -0.1519284       1  lh
63   1    both setar       2       0      7     1.8 -0.1519284       2  lh
64   1    both setar       2       0      7     1.8 -0.1519284       3  lh
65   1    both setar       2       0      8     1.4 -0.1519284       0  lh
66   1    both setar       2       0      8     1.4 -0.1519284       1  lh
67   1    both setar       2       0      8     1.4 -0.1519284       2  lh
68   1    both setar       2       0      8     1.4 -0.1519284       3  lh
69   1    both setar       2       0      9     1.9 -0.1519284       0  lh
70   1    both setar       2       0      9     1.9 -0.1519284       1  lh
71   1    both setar       2       0      9     1.9 -0.1519284       2  lh
72   1    both setar       2       0      9     1.9 -0.1519284       3  lh
      sim_1    sim_2         girf
1  3.693538 3.089970  0.603568229
2  2.782820 2.464490  0.318330489
3  2.182142 2.014250  0.167892038
4  2.157626 2.167275 -0.009648547
5  3.340374 2.736806  0.603568229
6  2.596556 2.278226  0.318330489
7  2.083904 1.972736  0.111167472
8  2.155044 2.190054 -0.035009545
9  2.524477 1.920909  0.603568229
10 2.223439 2.329375 -0.105935832
11 2.108166 2.104210  0.003956155
12 2.316160 2.413947 -0.097787350
13 3.659056 3.089970  0.569085637
14 2.764634 2.464490  0.300143878
15 2.172550 2.014250  0.158300160
16 2.152056 2.167275 -0.015218922
17 3.305891 2.736806  0.569085638
18 2.578370 2.278226  0.300143878
19 2.074312 1.972736  0.101575594
20 2.149303 2.190054 -0.040750415
21 2.489995 1.920909  0.569085637
22 2.204640 2.329375 -0.124735365
23 2.096957 2.104210 -0.007252044
24 2.309055 2.413947 -0.104892173
25 2.924575 3.089970 -0.165394899
26 2.377258 2.464490 -0.087231628
27 1.968243 2.014250 -0.046007204
28 2.193254 2.167275  0.025979421
29 2.571411 2.736806 -0.165394899
30 2.249027 2.278226 -0.029198863
31 2.123421 1.972736  0.150684435
32 2.271078 2.190054  0.081024602
33 1.755514 1.920909 -0.165394899
34 2.271974 2.329375 -0.057400743
35 2.181448 2.104210  0.077238091
36 2.361026 2.413947 -0.052921003
37 3.628321 2.663471  0.964850441
38 3.475528 2.522048  0.953479685
39 3.155501 2.240535  0.914966375
40 3.009627 2.271780  0.737846983
41 3.771368 2.806518  0.964850441
42 3.609303 2.678084  0.931219178
43 3.280606 2.356657  0.923948135
44 3.126622 2.240545  0.886076828
45 3.592559 2.627709  0.964850441
46 3.442084 2.491079  0.951005398
47 3.124225 2.214750  0.909475131
48 2.980378 2.304874  0.675504474
49 2.975111 2.663471  0.311640166
50 2.864658 2.522048  0.342609721
51 2.584227 2.240535  0.343692274
52 2.408012 2.271780  0.136232159
53 3.118158 2.806518  0.311640166
54 2.998433 2.678084  0.320349214
55 2.709332 2.356657  0.352674035
56 2.568028 2.240545  0.327482941
57 2.939349 2.627709  0.311640166
58 2.831214 2.491079  0.340135434
59 2.552951 2.214750  0.338201030
60 2.358341 2.304874  0.053467345
61 2.511542 2.663471 -0.151928371
62 2.386556 2.522048 -0.135492358
63 2.259203 2.240535  0.018667749
64 2.496997 2.271780  0.225217365
65 2.654590 2.806518 -0.151928371
66 2.514358 2.678084 -0.163726615
67 2.234132 2.356657 -0.122525645
68 2.268703 2.240545  0.028158031
69 2.475780 2.627709 -0.151928371
70 2.302973 2.491079 -0.188105876
71 2.294491 2.214750  0.079741063
72 2.491896 2.304874  0.187022147
> 
> 
> ############################
> ### Multivariate
> ############################
> 
> mod_1_multi <- models_multivariate$object[[1]]
> 
> tsDyn:::irf_1_shock(mod_1_multi, 
+                     shock = matrix(c(1, 0), nrow = 1),
+                     hist = matrix(c(0, 0), nrow = 1))
      var n.ahead     sim_1       sim_2
2  dolcan       0 1.0044599 0.004459875
3  dolcan       1 0.9941323 0.007024407
4  dolcan       2 1.0008185 0.026456765
5  dolcan       3 1.0216553 0.059895549
6  dolcan       4 1.0061378 0.056837340
7  dolcan       5 0.9831650 0.046182975
8  dolcan       6 0.9596563 0.034853288
9  dolcan       7 0.9587704 0.046008726
10 dolcan       8 0.9653731 0.064516487
11 dolcan       9 0.9606507 0.071564585
12 dolcan      10 0.9550930 0.077644203
14 cpiUSA       0 0.6090139 0.609013930
15 cpiUSA       1 1.1139139 1.253462618
16 cpiUSA       2 1.4151278 1.692744242
17 cpiUSA       3 1.7505716 2.164791748
18 cpiUSA       4 1.9134295 2.462806233
19 cpiUSA       5 2.1808617 2.863964313
20 cpiUSA       6 2.3620971 3.177511519
21 cpiUSA       7 2.5850500 3.531378130
22 cpiUSA       8 2.8053786 3.881238639
23 cpiUSA       9 2.9181798 4.122205554
24 cpiUSA      10 3.0836871 4.414528253
> 
> tsDyn:::irf_1_shock_ave(mod_1_multi, 
+                         shock = matrix(c(1, 0), nrow = 1),
+                         hist = matrix(c(0, 0), nrow = 1),
+                         seed = 123)
   n.ahead    var     sim_1      sim_2
1        0 cpiUSA 0.3490485 0.34904854
2        1 cpiUSA 0.5319193 0.67146801
3        2 cpiUSA 0.8172642 1.09488062
4        3 cpiUSA 0.9550125 1.36923266
5        4 cpiUSA 1.2361560 1.78553274
6        5 cpiUSA 1.6077044 2.29080706
7        6 cpiUSA 1.8798790 2.69529336
8        7 cpiUSA 2.0731147 3.01944289
9        8 cpiUSA 2.3639860 3.43984597
10       9 cpiUSA 2.5028769 3.70690264
11      10 cpiUSA 2.6643645 3.99520564
12       0 dolcan 1.0148879 0.01488794
13       1 dolcan 1.0141796 0.02707165
14       2 dolcan 1.0107712 0.03640946
15       3 dolcan 1.0078166 0.04605680
16       4 dolcan 1.0036250 0.05432453
17       5 dolcan 1.0030233 0.06604130
18       6 dolcan 0.9972723 0.07246932
19       7 dolcan 0.9948484 0.08208668
20       8 dolcan 0.9946215 0.09376488
21       9 dolcan 0.9923216 0.10323548
22      10 dolcan 0.9909097 0.11346094
> 
> GIRF(object=mod_1_multi, 
+      shock_li = list(matrix(c(1, 0), nrow = 1),
+                      matrix(c(0, 1), nrow = 1)),
+      hist_li = list(matrix(c(0, 0), nrow = 1),
+                     matrix(c(0, 1), nrow = 1)),
+      seed = 123) %>% 
+   head
  n_simu hist_l1 hist_l2 shock_var1 shock_var2 n.ahead    var     sim_1
1      1       0       0          1          0       0 cpiUSA 0.3490485
2      1       0       0          1          0       1 cpiUSA 0.5319193
3      1       0       0          1          0       2 cpiUSA 0.8172642
4      1       0       0          1          0       3 cpiUSA 0.9550125
5      1       0       0          1          0       4 cpiUSA 1.2361560
6      1       0       0          1          0       5 cpiUSA 1.6077044
      sim_2       girf
1 0.3490485  0.0000000
2 0.6714680 -0.1395487
3 1.0948806 -0.2776164
4 1.3692327 -0.4142202
5 1.7855327 -0.5493767
6 2.2908071 -0.6831026
> 
> proc.time()
   user  system elapsed 
  3.955   0.159   4.230 
