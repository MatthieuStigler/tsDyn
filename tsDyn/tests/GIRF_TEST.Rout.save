
R version 3.5.2 (2018-12-20) -- "Eggshell Igloo"
Copyright (C) 2018 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> 
> library(tsDyn)
> suppressMessages(library(tidyverse))
> 
> 
> plot_GIRF_line_low <-  tsDyn:::plot_GIRF_line_low
> irf_1_shock <- tsDyn:::irf_1_shock
> irf_1_shock_ave <- tsDyn:::irf_1_shock_ave
> 
> 
> 
> add.regime = FALSE
> shock_both = TRUE
> n.hist =  5
> n.shock = 20
> 
> ############################
> ### Load data
> ############################
> path_mod_uni <- system.file("inst/testdata/models_univariate.rds", package = "tsDyn")
> if(path_mod_uni=="") path_mod_uni <- system.file("testdata/models_univariate.rds", package = "tsDyn")
> 
> path_mod_multi <- system.file("inst/testdata/models_multivariate.rds", package = "tsDyn")
> if(path_mod_multi=="") path_mod_multi <- system.file("testdata/models_multivariate.rds", package = "tsDyn")
> 
> models_ar_setar <- readRDS(path_mod_uni) %>% 
+   filter(model %in% c("linear", "setar"))
> 
> models_multivariate <- readRDS(path_mod_multi)
> 
> ############################
> ### Univariate
> ############################
> 
> 
> mod_1_uni <- models_ar_setar %>% 
+   filter(model == "setar") %>% {.$object[[1]]}
> 
> mod_1_ar <- models_ar_setar %>% 
+   filter(model == "linear") %>% {.$object[[1]]}
> 
> 
> mod_1_uni_1_shock <- irf_1_shock(mod_1_uni, 
+                                  shock = 1,
+                                  hist = 0,
+                                  seed = 123)
> 
> mod_ar_1_shock <- irf_1_shock(mod_1_ar, shock = 1, hist = 0,seed = 123)
> 
> mod_1_uni_1_shock
   var n.ahead    sim_1    sim_2
2   lh       0 2.996618 1.996618
3   lh       1 2.155985 1.628571
4   lh       2 1.664436 2.461223
5   lh       3 3.650510 3.025997
6   lh       4 3.101592 2.772216
7   lh       5 2.823117 2.649399
8   lh       6 2.720745 2.629123
9   lh       7 1.983854 1.935531
10  lh       8 1.560084 1.534598
11  lh       9 2.506257 2.483755
12  lh      10 2.696483 2.684616
> plot_GIRF_line_low(x=mod_1_uni_1_shock)
> 
> plot_GIRF_line_low(x=mod_ar_1_shock)
> plot(irf(mod_1_ar, boot = FALSE))
> 
> mod_1_uni_1_shock_ave <- irf_1_shock_ave(object = mod_1_uni, 
+                                          shock = 1,
+                                          hist = 0, 
+                                          seed = 123)
> 
> plot_GIRF_line_low(x=mod_1_uni_1_shock_ave)
> 
> mod_1_uni_1_girf <- GIRF(object = mod_1_uni, 
+                          hist_li = list(1),
+                          shock_li = list(0.1, 0.11, -0.1, -0.11), 
+                          R = 2, 
+                          seed = 123)
> 
> head(mod_1_uni_1_girf)
  n_simu hist_x1_l1 shock_var1 n.ahead var    sim_1    sim_2        girf
1      1          1        0.1       0  lh 2.848254 2.748254 0.100000000
2      1          1        0.1       1  lh 2.284368 2.231627 0.052741426
3      1          1        0.1       2  lh 1.788436 1.760620 0.027816580
4      1          1        0.1       3  lh 2.518312 2.498697 0.019615216
5      1          1        0.1       4  lh 3.239090 3.226137 0.012953068
6      1          1        0.1       5  lh 2.617766 2.610934 0.006831633
> plot_GIRF_line_low(mod_1_uni_1_girf, n_simu  = 1:4)
> 
> mod_1_uni_1_girf_big <- GIRF(object = mod_1_uni, 
+                              n.hist = 50,
+                              R = 10, 
+                              seed = 123)
> 
> plot(x=mod_1_uni_1_girf_big, plot_type = "density")
> plot(x=mod_1_uni_1_girf_big, plot_type = "line", n_simu = 1:50, add_legend =FALSE)
> 
> ## Simple, given shocks
> models_ar_setar %>% 
+   head(2) %>% 
+   mutate(girf = map2(object, lag, ~GIRF(object=.x, n.ahead = 3,
+                                         hist_li = list(rep(1.6, .y)),
+                                         shock_li = list(0.01), R = 20, seed = 123) %>% as_tibble)) %>% 
+   unnest(girf) %>% 
+   as.data.frame()
  lag include  model nthresh thDelay n_simu hist_x1_l1 shock_var1 n.ahead var
1   1    both linear      NA      NA      1        1.6       0.01       0   x
2   1    both linear      NA      NA      1        1.6       0.01       1   x
3   1    both linear      NA      NA      1        1.6       0.01       2   x
4   1    both linear      NA      NA      1        1.6       0.01       3   x
5   1   const linear      NA      NA      1        1.6       0.01       0   x
6   1   const linear      NA      NA      1        1.6       0.01       1   x
7   1   const linear      NA      NA      1        1.6       0.01       2   x
8   1   const linear      NA      NA      1        1.6       0.01       3   x
     sim_1    sim_2        girf
1 2.000048 1.990048 0.010000000
2 2.000870 1.995579 0.005290559
3 1.878967 1.876168 0.002799001
4 1.964996 1.963515 0.001480828
5 2.153217 2.143217 0.010000000
6 2.212745 2.206885 0.005859870
7 2.118392 2.114958 0.003433807
8 2.230841 2.228829 0.002012166
> 
> ## Simple, random
> models_ar_setar %>% 
+   head(2) %>% 
+   mutate(girf = map(object, ~GIRF(object=., n.ahead = 3, n.hist = 3, n.shock = 3,
+                                   R = 10, seed = 123) %>% as_tibble)) %>% 
+   unnest(girf) %>% 
+   as.data.frame()
   lag include  model nthresh thDelay n_simu hist_x1_l1 shock_var1 n.ahead var
1    1    both linear      NA      NA      1        1.8  1.1850939       0   x
2    1    both linear      NA      NA      1        1.8  1.1850939       1   x
3    1    both linear      NA      NA      1        1.8  1.1850939       2   x
4    1    both linear      NA      NA      1        1.8  1.1850939       3   x
5    1    both linear      NA      NA      2        1.4  1.1850939       0   x
6    1    both linear      NA      NA      2        1.4  1.1850939       1   x
7    1    both linear      NA      NA      2        1.4  1.1850939       2   x
8    1    both linear      NA      NA      2        1.4  1.1850939       3   x
9    1    both linear      NA      NA      3        1.9  1.1850939       0   x
10   1    both linear      NA      NA      3        1.9  1.1850939       1   x
11   1    both linear      NA      NA      3        1.9  1.1850939       2   x
12   1    both linear      NA      NA      3        1.9  1.1850939       3   x
13   1    both linear      NA      NA      4        1.8  0.1208236       0   x
14   1    both linear      NA      NA      4        1.8  0.1208236       1   x
15   1    both linear      NA      NA      4        1.8  0.1208236       2   x
16   1    both linear      NA      NA      4        1.8  0.1208236       3   x
17   1    both linear      NA      NA      5        1.4  0.1208236       0   x
18   1    both linear      NA      NA      5        1.4  0.1208236       1   x
19   1    both linear      NA      NA      5        1.4  0.1208236       2   x
20   1    both linear      NA      NA      5        1.4  0.1208236       3   x
21   1    both linear      NA      NA      6        1.9  0.1208236       0   x
22   1    both linear      NA      NA      6        1.9  0.1208236       1   x
23   1    both linear      NA      NA      6        1.9  0.1208236       2   x
24   1    both linear      NA      NA      6        1.9  0.1208236       3   x
25   1    both linear      NA      NA      7        1.8 -0.2117849       0   x
26   1    both linear      NA      NA      7        1.8 -0.2117849       1   x
27   1    both linear      NA      NA      7        1.8 -0.2117849       2   x
28   1    both linear      NA      NA      7        1.8 -0.2117849       3   x
29   1    both linear      NA      NA      8        1.4 -0.2117849       0   x
30   1    both linear      NA      NA      8        1.4 -0.2117849       1   x
31   1    both linear      NA      NA      8        1.4 -0.2117849       2   x
32   1    both linear      NA      NA      8        1.4 -0.2117849       3   x
33   1    both linear      NA      NA      9        1.9 -0.2117849       0   x
34   1    both linear      NA      NA      9        1.9 -0.2117849       1   x
35   1    both linear      NA      NA      9        1.9 -0.2117849       2   x
36   1    both linear      NA      NA      9        1.9 -0.2117849       3   x
37   1   const linear      NA      NA      1        1.8  1.1453583       0   x
38   1   const linear      NA      NA      1        1.8  1.1453583       1   x
39   1   const linear      NA      NA      1        1.8  1.1453583       2   x
40   1   const linear      NA      NA      1        1.8  1.1453583       3   x
41   1   const linear      NA      NA      2        1.4  1.1453583       0   x
42   1   const linear      NA      NA      2        1.4  1.1453583       1   x
43   1   const linear      NA      NA      2        1.4  1.1453583       2   x
44   1   const linear      NA      NA      2        1.4  1.1453583       3   x
45   1   const linear      NA      NA      3        1.9  1.1453583       0   x
46   1   const linear      NA      NA      3        1.9  1.1453583       1   x
47   1   const linear      NA      NA      3        1.9  1.1453583       2   x
48   1   const linear      NA      NA      3        1.9  1.1453583       3   x
49   1   const linear      NA      NA      4        1.8  0.2797531       0   x
50   1   const linear      NA      NA      4        1.8  0.2797531       1   x
51   1   const linear      NA      NA      4        1.8  0.2797531       2   x
52   1   const linear      NA      NA      4        1.8  0.2797531       3   x
53   1   const linear      NA      NA      5        1.4  0.2797531       0   x
54   1   const linear      NA      NA      5        1.4  0.2797531       1   x
55   1   const linear      NA      NA      5        1.4  0.2797531       2   x
56   1   const linear      NA      NA      5        1.4  0.2797531       3   x
57   1   const linear      NA      NA      6        1.9  0.2797531       0   x
58   1   const linear      NA      NA      6        1.9  0.2797531       1   x
59   1   const linear      NA      NA      6        1.9  0.2797531       2   x
60   1   const linear      NA      NA      6        1.9  0.2797531       3   x
61   1   const linear      NA      NA      7        1.8 -0.2132404       0   x
62   1   const linear      NA      NA      7        1.8 -0.2132404       1   x
63   1   const linear      NA      NA      7        1.8 -0.2132404       2   x
64   1   const linear      NA      NA      7        1.8 -0.2132404       3   x
65   1   const linear      NA      NA      8        1.4 -0.2132404       0   x
66   1   const linear      NA      NA      8        1.4 -0.2132404       1   x
67   1   const linear      NA      NA      8        1.4 -0.2132404       2   x
68   1   const linear      NA      NA      8        1.4 -0.2132404       3   x
69   1   const linear      NA      NA      9        1.9 -0.2132404       0   x
70   1   const linear      NA      NA      9        1.9 -0.2132404       1   x
71   1   const linear      NA      NA      9        1.9 -0.2132404       2   x
72   1   const linear      NA      NA      9        1.9 -0.2132404       3   x
      sim_1    sim_2        girf
1  3.351347 2.166253  1.18509390
2  2.753365 2.126384  0.62698091
3  2.253972 1.922264  0.33170794
4  2.443931 2.268439  0.17549204
5  3.139724 1.954630  1.18509390
6  2.641405 2.014424  0.62698091
7  2.194739 1.863031  0.33170794
8  2.412593 2.237101  0.17549204
9  3.404252 2.219158  1.18509390
10 2.781355 2.154374  0.62698091
11 2.268780 1.937072  0.33170794
12 2.451765 2.276273  0.17549204
13 2.287076 2.166253  0.12082356
14 2.190307 2.126384  0.06392242
15 1.956082 1.922264  0.03381853
16 2.286331 2.268439  0.01789189
17 2.075454 1.954630  0.12082356
18 2.078347 2.014424  0.06392242
19 1.896849 1.863031  0.03381853
20 2.254993 2.237101  0.01789189
21 2.339982 2.219158  0.12082356
22 2.218297 2.154374  0.06392242
23 1.970891 1.937072  0.03381853
24 2.294165 2.276273  0.01789189
25 1.954468 2.166253 -0.21178486
26 2.014338 2.126384 -0.11204603
27 1.862985 1.922264 -0.05927861
28 2.237077 2.268439 -0.03136170
29 1.742846 1.954630 -0.21178486
30 1.902378 2.014424 -0.11204603
31 1.803752 1.863031 -0.05927861
32 2.205739 2.237101 -0.03136170
33 2.007374 2.219158 -0.21178486
34 2.042328 2.154374 -0.11204603
35 1.877793 1.937072 -0.05927861
36 2.244911 2.276273 -0.03136170
37 3.489244 2.343885  1.14535828
38 3.045798 2.374633  0.67116503
39 2.571933 2.178639  0.39329396
40 2.821133 2.590667  0.23046514
41 3.254849 2.109491  1.14535828
42 2.908446 2.237281  0.67116503
43 2.491446 2.098152  0.39329396
44 2.773968 2.543503  0.23046514
45 3.547842 2.402484  1.14535828
46 3.080137 2.408972  0.67116503
47 2.592054 2.198760  0.39329396
48 2.832924 2.602458  0.23046514
49 2.623639 2.343885  0.27975307
50 2.538565 2.374633  0.16393165
51 2.274701 2.178639  0.09606181
52 2.646958 2.590667  0.05629097
53 2.389244 2.109491  0.27975307
54 2.401213 2.237281  0.16393165
55 2.194214 2.098152  0.09606181
56 2.599794 2.543503  0.05629097
57 2.682237 2.402484  0.27975307
58 2.572903 2.408972  0.16393165
59 2.294822 2.198760  0.09606181
60 2.658749 2.602458  0.05629097
61 2.130645 2.343885 -0.21324042
62 2.249677 2.374633 -0.12495611
63 2.105416 2.178639 -0.07322265
64 2.547760 2.590667 -0.04290752
65 1.896250 2.109491 -0.21324042
66 2.112325 2.237281 -0.12495611
67 2.024929 2.098152 -0.07322265
68 2.500596 2.543503 -0.04290752
69 2.189244 2.402484 -0.21324042
70 2.284015 2.408972 -0.12495611
71 2.125538 2.198760 -0.07322265
72 2.559551 2.602458 -0.04290752
> 
> 
> ############################
> ### Multivariate
> ############################
> 
> mod_TVAR <- models_multivariate %>% 
+   filter(model == "TVAR" & lag ==2) %>% {.$object[[1]]}
> 
> mod_VAR <- models_multivariate %>% 
+   filter(model == "VAR"& lag ==2) %>% {.$object[[1]]}
> 
> mod_TVAR_1_shock <- irf_1_shock(object = mod_TVAR, 
+                                    shock = matrix(c(1, 0), nrow = 1),
+                                    hist = matrix(c(0, 0, 0, 0), nrow = 2),
+                                    seed = 123)
> 
> mod_VAR_1_shock <- irf_1_shock(object = mod_VAR, shock = matrix(c(1, 0), nrow = 1),
+                                hist = matrix(c(0, 0, 0, 0), nrow = 2), seed = 123)
> 
> 
> plot_GIRF_line_low(x=mod_VAR_1_shock)
> plot_GIRF_line_low(x=mod_TVAR_1_shock)
> 
> plot_GIRF_line_low(x=mod_TVAR_1_shock, var = "cpiUSA")
> plot_GIRF_line_low(x=mod_VAR_1_shock, var = "cpiUSA")
> 
> mod_TVAR_1_shock_ave <- irf_1_shock_ave(mod_TVAR, 
+                                         shock = matrix(c(1, 0), nrow = 1),
+                                         hist = matrix(c(0, 0, 0, 0), nrow = 2),
+                                         seed = 123)
> 
> 
> plot_GIRF_line_low(x=mod_TVAR_1_shock_ave)
> 
> TVAR_GIRF <- GIRF(object=mod_TVAR, 
+                   shock_li = list(matrix(c(1, 0), nrow = 1),
+                                   matrix(c(0, 1), nrow = 1)),
+                   hist_li = list(matrix(c(0, 0, 0, 0), nrow = 2),
+                                  matrix(c(0, 1, 0, 0), nrow = 2)),
+                   R = 2,
+                   seed = 123) 
> 
> gi_out <- GIRF(object=mod_TVAR, seed = 123, n.hist = 60, R = 2) 
> plot(density(residuals(mod_TVAR)[, 1]))
> head(gi_out)
  n_simu hist_x1_l1 hist_x1_l2 hist_x2_l1 hist_x2_l2 shock_var1 shock_var2
1      1     1.1647     1.1691      55.14      55.63 0.01642286 0.08589973
2      1     1.1647     1.1691      55.14      55.63 0.01642286 0.08589973
3      1     1.1647     1.1691      55.14      55.63 0.01642286 0.08589973
4      1     1.1647     1.1691      55.14      55.63 0.01642286 0.08589973
5      1     1.1647     1.1691      55.14      55.63 0.01642286 0.08589973
6      1     1.1647     1.1691      55.14      55.63 0.01642286 0.08589973
  n.ahead    var    sim_1    sim_2       girf
1       0 cpiUSA 56.13770 56.05180 0.08589973
2       1 cpiUSA 56.47797 56.37500 0.10297148
3       2 cpiUSA 56.73699 56.62066 0.11633341
4       3 cpiUSA 56.93175 56.80123 0.13052292
5       4 cpiUSA 57.21324 57.06854 0.14469542
6       5 cpiUSA 57.35781 57.19943 0.15837356
> plot(x=gi_out, var = "dolcan")
> plot(x=gi_out, var = "cpiUSA")
> 
> ## Simple, random
> models_multivariate %>% 
+   head(2) %>% 
+   mutate(girf = map(object, ~GIRF(object=., n.ahead = 3, n.hist = 3, n.shock = 3,
+                                   R = 20, seed = 123) %>% as_tibble)) %>% 
+   unnest(girf) %>% 
+   as.data.frame()
    lag include model nthresh n_simu hist_x1_l1 hist_x2_l1   shock_var1
1     1    both   VAR      NA      1     1.1691      55.63  0.002970819
2     1    both   VAR      NA      1     1.1691      55.63  0.002970819
3     1    both   VAR      NA      1     1.1691      55.63  0.002970819
4     1    both   VAR      NA      1     1.1691      55.63  0.002970819
5     1    both   VAR      NA      1     1.1691      55.63  0.002970819
6     1    both   VAR      NA      1     1.1691      55.63  0.002970819
7     1    both   VAR      NA      1     1.1691      55.63  0.002970819
8     1    both   VAR      NA      1     1.1691      55.63  0.002970819
9     1    both   VAR      NA      2     1.3830      96.73  0.002970819
10    1    both   VAR      NA      2     1.3830      96.73  0.002970819
11    1    both   VAR      NA      2     1.3830      96.73  0.002970819
12    1    both   VAR      NA      2     1.3830      96.73  0.002970819
13    1    both   VAR      NA      2     1.3830      96.73  0.002970819
14    1    both   VAR      NA      2     1.3830      96.73  0.002970819
15    1    both   VAR      NA      2     1.3830      96.73  0.002970819
16    1    both   VAR      NA      2     1.3830      96.73  0.002970819
17    1    both   VAR      NA      3     1.2484      66.87  0.002970819
18    1    both   VAR      NA      3     1.2484      66.87  0.002970819
19    1    both   VAR      NA      3     1.2484      66.87  0.002970819
20    1    both   VAR      NA      3     1.2484      66.87  0.002970819
21    1    both   VAR      NA      3     1.2484      66.87  0.002970819
22    1    both   VAR      NA      3     1.2484      66.87  0.002970819
23    1    both   VAR      NA      3     1.2484      66.87  0.002970819
24    1    both   VAR      NA      3     1.2484      66.87  0.002970819
25    1    both   VAR      NA      4     1.1691      55.63  0.017232801
26    1    both   VAR      NA      4     1.1691      55.63  0.017232801
27    1    both   VAR      NA      4     1.1691      55.63  0.017232801
28    1    both   VAR      NA      4     1.1691      55.63  0.017232801
29    1    both   VAR      NA      4     1.1691      55.63  0.017232801
30    1    both   VAR      NA      4     1.1691      55.63  0.017232801
31    1    both   VAR      NA      4     1.1691      55.63  0.017232801
32    1    both   VAR      NA      4     1.1691      55.63  0.017232801
33    1    both   VAR      NA      5     1.3830      96.73  0.017232801
34    1    both   VAR      NA      5     1.3830      96.73  0.017232801
35    1    both   VAR      NA      5     1.3830      96.73  0.017232801
36    1    both   VAR      NA      5     1.3830      96.73  0.017232801
37    1    both   VAR      NA      5     1.3830      96.73  0.017232801
38    1    both   VAR      NA      5     1.3830      96.73  0.017232801
39    1    both   VAR      NA      5     1.3830      96.73  0.017232801
40    1    both   VAR      NA      5     1.3830      96.73  0.017232801
41    1    both   VAR      NA      6     1.2484      66.87  0.017232801
42    1    both   VAR      NA      6     1.2484      66.87  0.017232801
43    1    both   VAR      NA      6     1.2484      66.87  0.017232801
44    1    both   VAR      NA      6     1.2484      66.87  0.017232801
45    1    both   VAR      NA      6     1.2484      66.87  0.017232801
46    1    both   VAR      NA      6     1.2484      66.87  0.017232801
47    1    both   VAR      NA      6     1.2484      66.87  0.017232801
48    1    both   VAR      NA      6     1.2484      66.87  0.017232801
49    1    both   VAR      NA      7     1.1691      55.63 -0.001587729
50    1    both   VAR      NA      7     1.1691      55.63 -0.001587729
51    1    both   VAR      NA      7     1.1691      55.63 -0.001587729
52    1    both   VAR      NA      7     1.1691      55.63 -0.001587729
53    1    both   VAR      NA      7     1.1691      55.63 -0.001587729
54    1    both   VAR      NA      7     1.1691      55.63 -0.001587729
55    1    both   VAR      NA      7     1.1691      55.63 -0.001587729
56    1    both   VAR      NA      7     1.1691      55.63 -0.001587729
57    1    both   VAR      NA      8     1.3830      96.73 -0.001587729
58    1    both   VAR      NA      8     1.3830      96.73 -0.001587729
59    1    both   VAR      NA      8     1.3830      96.73 -0.001587729
60    1    both   VAR      NA      8     1.3830      96.73 -0.001587729
61    1    both   VAR      NA      8     1.3830      96.73 -0.001587729
62    1    both   VAR      NA      8     1.3830      96.73 -0.001587729
63    1    both   VAR      NA      8     1.3830      96.73 -0.001587729
64    1    both   VAR      NA      8     1.3830      96.73 -0.001587729
65    1    both   VAR      NA      9     1.2484      66.87 -0.001587729
66    1    both   VAR      NA      9     1.2484      66.87 -0.001587729
67    1    both   VAR      NA      9     1.2484      66.87 -0.001587729
68    1    both   VAR      NA      9     1.2484      66.87 -0.001587729
69    1    both   VAR      NA      9     1.2484      66.87 -0.001587729
70    1    both   VAR      NA      9     1.2484      66.87 -0.001587729
71    1    both   VAR      NA      9     1.2484      66.87 -0.001587729
72    1    both   VAR      NA      9     1.2484      66.87 -0.001587729
73    1   const   VAR      NA      1     1.1691      55.63  0.003137132
74    1   const   VAR      NA      1     1.1691      55.63  0.003137132
75    1   const   VAR      NA      1     1.1691      55.63  0.003137132
76    1   const   VAR      NA      1     1.1691      55.63  0.003137132
77    1   const   VAR      NA      1     1.1691      55.63  0.003137132
78    1   const   VAR      NA      1     1.1691      55.63  0.003137132
79    1   const   VAR      NA      1     1.1691      55.63  0.003137132
80    1   const   VAR      NA      1     1.1691      55.63  0.003137132
81    1   const   VAR      NA      2     1.3830      96.73  0.003137132
82    1   const   VAR      NA      2     1.3830      96.73  0.003137132
83    1   const   VAR      NA      2     1.3830      96.73  0.003137132
84    1   const   VAR      NA      2     1.3830      96.73  0.003137132
85    1   const   VAR      NA      2     1.3830      96.73  0.003137132
86    1   const   VAR      NA      2     1.3830      96.73  0.003137132
87    1   const   VAR      NA      2     1.3830      96.73  0.003137132
88    1   const   VAR      NA      2     1.3830      96.73  0.003137132
89    1   const   VAR      NA      3     1.2484      66.87  0.003137132
90    1   const   VAR      NA      3     1.2484      66.87  0.003137132
91    1   const   VAR      NA      3     1.2484      66.87  0.003137132
92    1   const   VAR      NA      3     1.2484      66.87  0.003137132
93    1   const   VAR      NA      3     1.2484      66.87  0.003137132
94    1   const   VAR      NA      3     1.2484      66.87  0.003137132
95    1   const   VAR      NA      3     1.2484      66.87  0.003137132
96    1   const   VAR      NA      3     1.2484      66.87  0.003137132
97    1   const   VAR      NA      4     1.1691      55.63  0.017249509
98    1   const   VAR      NA      4     1.1691      55.63  0.017249509
99    1   const   VAR      NA      4     1.1691      55.63  0.017249509
100   1   const   VAR      NA      4     1.1691      55.63  0.017249509
101   1   const   VAR      NA      4     1.1691      55.63  0.017249509
102   1   const   VAR      NA      4     1.1691      55.63  0.017249509
103   1   const   VAR      NA      4     1.1691      55.63  0.017249509
104   1   const   VAR      NA      4     1.1691      55.63  0.017249509
105   1   const   VAR      NA      5     1.3830      96.73  0.017249509
106   1   const   VAR      NA      5     1.3830      96.73  0.017249509
107   1   const   VAR      NA      5     1.3830      96.73  0.017249509
108   1   const   VAR      NA      5     1.3830      96.73  0.017249509
109   1   const   VAR      NA      5     1.3830      96.73  0.017249509
110   1   const   VAR      NA      5     1.3830      96.73  0.017249509
111   1   const   VAR      NA      5     1.3830      96.73  0.017249509
112   1   const   VAR      NA      5     1.3830      96.73  0.017249509
113   1   const   VAR      NA      6     1.2484      66.87  0.017249509
114   1   const   VAR      NA      6     1.2484      66.87  0.017249509
115   1   const   VAR      NA      6     1.2484      66.87  0.017249509
116   1   const   VAR      NA      6     1.2484      66.87  0.017249509
117   1   const   VAR      NA      6     1.2484      66.87  0.017249509
118   1   const   VAR      NA      6     1.2484      66.87  0.017249509
119   1   const   VAR      NA      6     1.2484      66.87  0.017249509
120   1   const   VAR      NA      6     1.2484      66.87  0.017249509
121   1   const   VAR      NA      7     1.1691      55.63 -0.001335706
122   1   const   VAR      NA      7     1.1691      55.63 -0.001335706
123   1   const   VAR      NA      7     1.1691      55.63 -0.001335706
124   1   const   VAR      NA      7     1.1691      55.63 -0.001335706
125   1   const   VAR      NA      7     1.1691      55.63 -0.001335706
126   1   const   VAR      NA      7     1.1691      55.63 -0.001335706
127   1   const   VAR      NA      7     1.1691      55.63 -0.001335706
128   1   const   VAR      NA      7     1.1691      55.63 -0.001335706
129   1   const   VAR      NA      8     1.3830      96.73 -0.001335706
130   1   const   VAR      NA      8     1.3830      96.73 -0.001335706
131   1   const   VAR      NA      8     1.3830      96.73 -0.001335706
132   1   const   VAR      NA      8     1.3830      96.73 -0.001335706
133   1   const   VAR      NA      8     1.3830      96.73 -0.001335706
134   1   const   VAR      NA      8     1.3830      96.73 -0.001335706
135   1   const   VAR      NA      8     1.3830      96.73 -0.001335706
136   1   const   VAR      NA      8     1.3830      96.73 -0.001335706
137   1   const   VAR      NA      9     1.2484      66.87 -0.001335706
138   1   const   VAR      NA      9     1.2484      66.87 -0.001335706
139   1   const   VAR      NA      9     1.2484      66.87 -0.001335706
140   1   const   VAR      NA      9     1.2484      66.87 -0.001335706
141   1   const   VAR      NA      9     1.2484      66.87 -0.001335706
142   1   const   VAR      NA      9     1.2484      66.87 -0.001335706
143   1   const   VAR      NA      9     1.2484      66.87 -0.001335706
144   1   const   VAR      NA      9     1.2484      66.87 -0.001335706
     shock_var2 n.ahead    var     sim_1     sim_2         girf
1    0.21386006       0 cpiUSA 56.266043 56.052183  0.213860064
2    0.21386006       1 cpiUSA 56.594611 56.380678  0.213932980
3    0.21386006       2 cpiUSA 56.963295 56.749288  0.214007065
4    0.21386006       3 cpiUSA 57.275086 57.061003  0.214082307
5    0.21386006       0 dolcan  1.178962  1.175991  0.002970819
6    0.21386006       1 dolcan  1.185597  1.182633  0.002963636
7    0.21386006       2 dolcan  1.184207  1.181251  0.002956556
8    0.21386006       3 dolcan  1.186663  1.183714  0.002949579
9    0.21386006       0 cpiUSA 97.429881 97.216021  0.213860064
10   0.21386006       1 cpiUSA 97.821982 97.608049  0.213932980
11   0.21386006       2 cpiUSA 98.253898 98.039891  0.214007065
12   0.21386006       3 cpiUSA 98.628625 98.414543  0.214082307
13   0.21386006       0 dolcan  1.396085  1.393114  0.002970819
14   0.21386006       1 dolcan  1.405910  1.402946  0.002963636
15   0.21386006       2 dolcan  1.407678  1.404722  0.002956556
16   0.21386006       3 dolcan  1.413261  1.410312  0.002949579
17   0.21386006       0 cpiUSA 67.520598 67.306738  0.213860064
18   0.21386006       1 cpiUSA 67.863669 67.649736  0.213932980
19   0.21386006       2 cpiUSA 68.246804 68.032797  0.214007065
20   0.21386006       3 cpiUSA 68.572995 68.358913  0.214082307
21   0.21386006       0 dolcan  1.258875  1.255904  0.002970819
22   0.21386006       1 dolcan  1.266117  1.263154  0.002963636
23   0.21386006       2 dolcan  1.265329  1.262373  0.002956556
24   0.21386006       3 dolcan  1.268381  1.265432  0.002949579
25  -0.09778740       0 cpiUSA 55.954396 56.052183 -0.097787397
26  -0.09778740       1 cpiUSA 56.280263 56.380678 -0.100415116
27  -0.09778740       2 cpiUSA 56.646272 56.749288 -0.103015837
28  -0.09778740       3 cpiUSA 56.955414 57.061003 -0.105589870
29  -0.09778740       0 dolcan  1.193224  1.175991  0.017232801
30  -0.09778740       1 dolcan  1.199630  1.182633  0.016996406
31  -0.09778740       2 dolcan  1.198013  1.181251  0.016762676
32  -0.09778740       3 dolcan  1.200245  1.183714  0.016531582
33  -0.09778740       0 cpiUSA 97.118233 97.216021 -0.097787397
34  -0.09778740       1 cpiUSA 97.507633 97.608049 -0.100415116
35  -0.09778740       2 cpiUSA 97.936875 98.039891 -0.103015837
36  -0.09778740       3 cpiUSA 98.308953 98.414543 -0.105589870
37  -0.09778740       0 dolcan  1.410347  1.393114  0.017232801
38  -0.09778740       1 dolcan  1.419942  1.402946  0.016996406
39  -0.09778740       2 dolcan  1.421485  1.404722  0.016762676
40  -0.09778740       3 dolcan  1.426843  1.410312  0.016531582
41  -0.09778740       0 cpiUSA 67.208951 67.306738 -0.097787397
42  -0.09778740       1 cpiUSA 67.549321 67.649736 -0.100415116
43  -0.09778740       2 cpiUSA 67.929781 68.032797 -0.103015837
44  -0.09778740       3 cpiUSA 68.253323 68.358913 -0.105589870
45  -0.09778740       0 dolcan  1.273137  1.255904  0.017232801
46  -0.09778740       1 dolcan  1.280150  1.263154  0.016996406
47  -0.09778740       2 dolcan  1.279135  1.262373  0.016762676
48  -0.09778740       3 dolcan  1.281963  1.265432  0.016531582
49   0.03719505       0 cpiUSA 56.089378 56.052183  0.037195049
50   0.03719505       1 cpiUSA 56.418180 56.380678  0.037501400
51   0.03719505       2 cpiUSA 56.787093 56.749288  0.037804838
52   0.03719505       3 cpiUSA 57.099109 57.061003  0.038105396
53   0.03719505       0 dolcan  1.174404  1.175991 -0.001587729
54   0.03719505       1 dolcan  1.181071  1.182633 -0.001561848
55   0.03719505       2 dolcan  1.179714  1.181251 -0.001536256
56   0.03719505       3 dolcan  1.182203  1.183714 -0.001510950
57   0.03719505       0 cpiUSA 97.253216 97.216021  0.037195049
58   0.03719505       1 cpiUSA 97.645550 97.608049  0.037501400
59   0.03719505       2 cpiUSA 98.077696 98.039891  0.037804838
60   0.03719505       3 cpiUSA 98.452648 98.414543  0.038105396
61   0.03719505       0 dolcan  1.391526  1.393114 -0.001587729
62   0.03719505       1 dolcan  1.401384  1.402946 -0.001561848
63   0.03719505       2 dolcan  1.403186  1.404722 -0.001536256
64   0.03719505       3 dolcan  1.408801  1.410312 -0.001510950
65   0.03719505       0 cpiUSA 67.343933 67.306738  0.037195049
66   0.03719505       1 cpiUSA 67.687238 67.649736  0.037501400
67   0.03719505       2 cpiUSA 68.070602 68.032797  0.037804838
68   0.03719505       3 cpiUSA 68.397018 68.358913  0.038105396
69   0.03719505       0 dolcan  1.254317  1.255904 -0.001587729
70   0.03719505       1 dolcan  1.261592  1.263154 -0.001561848
71   0.03719505       2 dolcan  1.260836  1.262373 -0.001536256
72   0.03719505       3 dolcan  1.263921  1.265432 -0.001510950
73   0.21929330       0 cpiUSA 56.199935 55.980642  0.219293298
74   0.21929330       1 cpiUSA 56.455549 56.236779  0.218769806
75   0.21929330       2 cpiUSA 56.753373 56.535123  0.218250241
76   0.21929330       3 cpiUSA 56.991844 56.774110  0.217734558
77   0.21929330       0 dolcan  1.176939  1.173801  0.003137132
78   0.21929330       1 dolcan  1.181353  1.178242  0.003110671
79   0.21929330       2 dolcan  1.177820  1.174735  0.003084518
80   0.21929330       3 dolcan  1.178071  1.175012  0.003058670
81   0.21929330       0 cpiUSA 97.254599 97.035306  0.219293298
82   0.21929330       1 cpiUSA 97.464910 97.246141  0.218769806
83   0.21929330       2 cpiUSA 97.717467 97.499216  0.218250241
84   0.21929330       3 cpiUSA 97.910703 97.692968  0.217734558
85   0.21929330       0 dolcan  1.390719  1.387582  0.003137132
86   0.21929330       1 dolcan  1.395013  1.391902  0.003110671
87   0.21929330       2 dolcan  1.391358  1.388273  0.003084518
88   0.21929330       3 dolcan  1.391485  1.388427  0.003058670
89   0.21929330       0 cpiUSA 67.424602 67.205308  0.219293298
90   0.21929330       1 cpiUSA 67.664930 67.446160  0.218769806
91   0.21929330       2 cpiUSA 67.947517 67.729267  0.218250241
92   0.21929330       3 cpiUSA 68.170798 67.953063  0.217734558
93   0.21929330       0 dolcan  1.255937  1.252800  0.003137132
94   0.21929330       1 dolcan  1.260052  1.256941  0.003110671
95   0.21929330       2 dolcan  1.256223  1.253139  0.003084518
96   0.21929330       3 dolcan  1.256181  1.253122  0.003058670
97  -0.09724157       0 cpiUSA 55.883400 55.980642 -0.097241574
98  -0.09724157       1 cpiUSA 56.137139 56.236779 -0.099639476
99  -0.09724157       2 cpiUSA 56.433119 56.535123 -0.102004120
100 -0.09724157       3 cpiUSA 56.669774 56.774110 -0.104335913
101 -0.09724157       0 dolcan  1.191051  1.173801  0.017249509
102 -0.09724157       1 dolcan  1.195262  1.178242  0.017020046
103 -0.09724157       2 dolcan  1.191529  1.174735  0.016793398
104 -0.09724157       3 dolcan  1.191582  1.175012  0.016569530
105 -0.09724157       0 cpiUSA 96.938064 97.035306 -0.097241574
106 -0.09724157       1 cpiUSA 97.146501 97.246141 -0.099639476
107 -0.09724157       2 cpiUSA 97.397212 97.499216 -0.102004120
108 -0.09724157       3 cpiUSA 97.588632 97.692968 -0.104335913
109 -0.09724157       0 dolcan  1.404832  1.387582  0.017249509
110 -0.09724157       1 dolcan  1.408922  1.391902  0.017020046
111 -0.09724157       2 dolcan  1.405067  1.388273  0.016793398
112 -0.09724157       3 dolcan  1.404996  1.388427  0.016569530
113 -0.09724157       0 cpiUSA 67.108067 67.205308 -0.097241574
114 -0.09724157       1 cpiUSA 67.346521 67.446160 -0.099639476
115 -0.09724157       2 cpiUSA 67.627263 67.729267 -0.102004120
116 -0.09724157       3 cpiUSA 67.848727 67.953063 -0.104335913
117 -0.09724157       0 dolcan  1.270049  1.252800  0.017249509
118 -0.09724157       1 dolcan  1.273961  1.256941  0.017020046
119 -0.09724157       2 dolcan  1.269932  1.253139  0.016793398
120 -0.09724157       3 dolcan  1.269692  1.253122  0.016569530
121  0.04542832       0 cpiUSA 56.026070 55.980642  0.045428320
122  0.04542832       1 cpiUSA 56.282379 56.236779  0.045600024
123  0.04542832       2 cpiUSA 56.580892 56.535123  0.045768814
124  0.04542832       3 cpiUSA 56.820044 56.774110  0.045934725
125  0.04542832       0 dolcan  1.172466  1.173801 -0.001335706
126  0.04542832       1 dolcan  1.176926  1.178242 -0.001315496
127  0.04542832       2 dolcan  1.173440  1.174735 -0.001295536
128  0.04542832       3 dolcan  1.173736  1.175012 -0.001275823
129  0.04542832       0 cpiUSA 97.080734 97.035306  0.045428320
130  0.04542832       1 cpiUSA 97.291741 97.246141  0.045600024
131  0.04542832       2 cpiUSA 97.544985 97.499216  0.045768814
132  0.04542832       3 cpiUSA 97.738903 97.692968  0.045934725
133  0.04542832       0 dolcan  1.386246  1.387582 -0.001335706
134  0.04542832       1 dolcan  1.390586  1.391902 -0.001315496
135  0.04542832       2 dolcan  1.386978  1.388273 -0.001295536
136  0.04542832       3 dolcan  1.387151  1.388427 -0.001275823
137  0.04542832       0 cpiUSA 67.250737 67.205308  0.045428320
138  0.04542832       1 cpiUSA 67.491760 67.446160  0.045600024
139  0.04542832       2 cpiUSA 67.775036 67.729267  0.045768814
140  0.04542832       3 cpiUSA 67.998998 67.953063  0.045934725
141  0.04542832       0 dolcan  1.251464  1.252800 -0.001335706
142  0.04542832       1 dolcan  1.255626  1.256941 -0.001315496
143  0.04542832       2 dolcan  1.251843  1.253139 -0.001295536
144  0.04542832       3 dolcan  1.251846  1.253122 -0.001275823
> 
> 
> proc.time()
   user  system elapsed 
 26.862   0.127  26.972 
