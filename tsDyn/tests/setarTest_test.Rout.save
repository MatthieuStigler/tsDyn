
R version 3.6.1 (2019-07-05) -- "Action of the Toes"
Copyright (C) 2019 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> library(tsDyn)
Registered S3 method overwritten by 'xts':
  method     from
  as.zoo.xts zoo 
Registered S3 method overwritten by 'quantmod':
  method            from
  as.zoo.data.frame zoo 
Registered S3 methods overwritten by 'forecast':
  method             from    
  fitted.fracdiff    fracdiff
  residuals.fracdiff fracdiff
> suppressMessages(library(tidyverse))
> suppressWarnings(RNGversion("3.5.3"))
> 
> data(IIPUs)
> 
> ### grid ###
> grid <-  crossing(include = c( "const", "trend","none", "both"),
+                   lag = 1:2L, 
+                   thDelay = 0:1L, 
+                   test = c("1vs", "2vs3")) %>% 
+   filter(thDelay<lag)
> 
> 
> ### run ###
> res <- grid %>% 
+   mutate(dat = pmap(list(include, lag, thDelay, test),
+                     ~setarTest(IIPUs, 
+                                include= ..1,
+                                m = ..2,
+                                thDelay = ..3,
+                                test = ..4,
+                                nboot = 2)))
Warning messages:
1: 
With the threshold you gave (-2.72533309207574) there is a regime with less than trim=15% observations (10.64%, 89.36%, )
 
2: Possible unit root in the high  regime. Roots are: 0.981 11.6058 
3: 
With the threshold you gave (-2.72533309207574) there is a regime with less than trim=15% observations (10.64%, 89.36%, )
 
4: Possible unit root in the high  regime. Roots are: 0.9871 13.2387 
5: 
With the threshold you gave (-3.19877483971203) there is a regime with less than trim=15% observations (10.18%, 89.82%, )
 
6: 
With the threshold you gave (-2.72533309207574) there is a regime with less than trim=15% observations (10.64%, 89.36%, )
 
7: 
With the threshold you gave (-3.19877483971203) there is a regime with less than trim=15% observations (10.18%, 89.82%, )
 
8: 
With the threshold you gave (-2.72533309207574) there is a regime with less than trim=15% observations (10.64%, 89.36%, )
 
> 
> 
> ### show F tests ###
> res %>% 
+   mutate(Ftests = map(dat, ~enframe(.$Ftests))) %>% 
+   select(-dat) %>% 
+   unnest(Ftests)
# A tibble: 72 x 6
   include   lag thDelay test  name  value
   <chr>   <int>   <int> <chr> <chr> <dbl>
 1 both        1       0 1vs   1vs2   5.16
 2 both        1       0 1vs   1vs3  10.2 
 3 both        1       0 1vs   2vs3   5.01
 4 both        1       0 2vs3  1vs2   5.16
 5 both        1       0 2vs3  1vs3  10.2 
 6 both        1       0 2vs3  2vs3   5.01
 7 both        2       0 1vs   1vs2  15.0 
 8 both        2       0 1vs   1vs3  28.8 
 9 both        2       0 1vs   2vs3  13.4 
10 both        2       0 2vs3  1vs2  15.0 
# … with 62 more rows
> 
> res %>% 
+   mutate(Ftests = map(dat, ~enframe(.$SSRs))) %>% 
+   select(-dat) %>% 
+   unnest(Ftests)
# A tibble: 72 x 6
   include   lag thDelay test   name value
   <chr>   <int>   <int> <chr> <int> <dbl>
 1 both        1       0 1vs       1  606.
 2 both        1       0 1vs       2  599.
 3 both        1       0 1vs       3  593.
 4 both        1       0 2vs3      1  606.
 5 both        1       0 2vs3      2  599.
 6 both        1       0 2vs3      3  593.
 7 both        2       0 1vs       1  533.
 8 both        2       0 1vs       2  516.
 9 both        2       0 1vs       3  501.
10 both        2       0 2vs3      1  533.
# … with 62 more rows
> 
> 
> proc.time()
   user  system elapsed 
 30.625   0.220  31.026 
